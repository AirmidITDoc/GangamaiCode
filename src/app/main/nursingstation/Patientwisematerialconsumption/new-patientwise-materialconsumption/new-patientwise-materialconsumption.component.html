<div class="modal-wrapper grid-container">
    <!-- Modal header -->
    <div class="modal-header accent">
        <div class="modal-header-content">
            <div class="modal-header-title">
                <span [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}"> New Material Consumption</span>
            </div>
            <div class="modal-header-right">
                <div class="close-icon">
                    <button mat-icon-button tabIndex="-1" [mat-dialog-close]="true" aria-label="Close dialog">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal body -->
    <div class="modal-body" fusePerfectScrollbar>
    <div class="modal-body-container">
            <form [formGroup]="myForm">
                <div fxLayout="column" class="gap-12">
                    <div class="modal-card-container">
                        <mat-card>
                            <div fxLayout="row wrap" fxLayoutGap="12px grid">
                                <!-- <div>
                                    <app-airmid-slider 
                                        label="IsPatientWiseConsumption"   
                                        formControlName="consumption" 
                                        [formGroup]="myForm" 
                                        [(ngModel)]="isPatientWiseConsumption">
                                    </app-airmid-slider>
                                </div> -->
                                <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <div fxLayout="row" class="gap-8">
                                        <mat-checkbox  formControlName="IsHealthCard" (change)="chkHealthcard($event)" style="padding: 15px;">IsPatientWiseConsumption
                                        </mat-checkbox>
                                    </div>
                                </div>
                            </div>
                            <div fxLayout="row wrap" fxLayoutGap="12px grid">
                                
                                <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-dropdown 
                                        label="FromStore" 
                                        formControlName="itemName"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().itemName"
                                        [mode]="autocompleteModeStoreName">
                                    </airmid-dropdown>
                                </div>

                                <div>
                                    <div fxLayout="row" [formGroup]="myForm"
                                    *ngIf="Healthcardflag" fxLayout.sm="column" class="gap-16" fxLayoutAlign="start center center">
                                        
                                        <div class="radio-container">
                                            <mat-radio-group fxLayout="row" aria-label="Select an option" formControlName="PatientType"
                                                name="PatientType" (change)="onChangePatientType($event)"
                                                (blur)="onChangePatientType($event)" [(ngModel)]="vSelectedOption">
                                                <mat-radio-button value="OP">OP</mat-radio-button>
                                                <mat-radio-button value="IP">IP</mat-radio-button>
                                            </mat-radio-group>
                                        </div>

                                        <div class="input-container gap-8" fxFlex="80%">
        
                                            <airmid-autocomplete lbl="RgId" 
                                            *ngIf="myForm.get('PatientType')?.value == 'OP'"
                                                [formGroup]="myForm" formControlName="RegID" 
                                                placeholderText="OP-RegNo/FirstName/LastName"
                                                    ApiUrl="VisitDetail/search-patient?Keyword=" 
                                                (selectionChange)="getSelectedObjOP($event)"
                                                TextField="formattedText" ValueField="regId">
                                            </airmid-autocomplete>
        
                                            <airmid-autocomplete lbl="RgId" 
                                            *ngIf="myForm.get('PatientType')?.value == 'IP'"
                                                [formGroup]="myForm" formControlName="RegID" 
                                                placeholderText="IP-RegNo/FirstName/LastName" 
                                                ApiUrl="Admission/search-patient?Keyword=" 
                                                (selectionChange)="getSelectedObjIP($event)"
                                                ValueField="admissionID" TextField="firstName">
                                            </airmid-autocomplete>
                                        </div>
                                    </div>
                                    
                                </div>

                            </div>

                            <div fxLayout="row wrap" fxLayoutGap="12px grid">
                                <!-- 1st -->
                                <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-dropdown 
                                        label="ItemName" 
                                        formControlName="itemName"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().itemName"
                                        [mode]="autocompleteModeItemName">
                                    </airmid-dropdown>
                                </div>
                                <!-- 2nd -->
                                <div fxFlex="10%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="BalQty" 
                                        formControlName="balqty" 
                                        [value]="data?.balqty"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().balqty"
                                        [maxLength]="50">
                                    </airmid-textbox>
                                </div>
                                <!-- 3rd -->
                                <div fxFlex="10%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="UsedQty" 
                                        formControlName="usedqty" 
                                        [value]="data?.usedqty"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().usedqty"
                                        [maxLength]="50">
                                    </airmid-textbox>
                                </div>
                                <!-- 4th -->
                                <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="Remark" 
                                        formControlName="remark" 
                                        [value]="data?.remark"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().remark"
                                        [maxLength]="50">
                                    </airmid-textbox>
                                </div>
                                <!-- 5th -->
                                <div fxFlex="22%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-datepicker [formGroup]="myForm" [isRangePicker]="true"
                                        formStartControlName="startdate" formEndControlName="enddate" [(fromValue)]="gridConfig.filters[1].fieldValue"
                                        [(toValue)]="gridConfig.filters[2].fieldValue">
                                    </airmid-datepicker>
                                </div>
                                <!-- 6th -->
                                <div class="input-add-button">
                                    <button class="btn btn-primary" (click)="onSaveEntry()" [disabled]="!add" addbutton> Add </button>
                                </div>
                            </div>
                        </mat-card>
                    </div>
                    <div class="modal-card-container table-container">
                        <div class="table-row gap-12" fxLayout="column" fxLayout.gt-md="row">
                            <mat-card fxFlexFill>

                                <div fusePerfectScrollbar
                                    class="page-layout simple left-sidebar inner-sidebar inner-scroll update-grn mat-form-field-auto"
                                    dynamicTableHeight>
                                    <div id="contacts" class="page-layout simple left-sidebar inner-sidebar inner-scroll">
                                        <airmid-table [gridConfig]="gridConfig" #grid :ShowFilter="false" :ShowButtons="false">
                                            <ng-container filters>

                                            </ng-container>
                                        </airmid-table>
                                    </div>
                                </div>

                                <div fxLayout="row" fxLayoutGap="20px" fxLayoutALign="start center">

                                    <span class="net-amt-mat-label" style="font-weight:bold;padding-bottom: 8px;">No Of
                                        Item:
                                    </span>&nbsp;
                                    <!-- <span class="net-amt-value"
                                        style="margin-left:10px;font-weight:bolder;color: blue;">{{dsNewmaterialList.data.length}}
                                    </span> -->&nbsp;
        
    
                                    <span class="net-amt-mat-label" style="font-weight:bold;margin-left:20px;">Total MRPAmount
                                        Amount :
                                    </span>&nbsp;
                                    <!-- <span class="net-amt-value text-primary"
                                        style="margin-left:10px;font-weight:bolder;color: blue;">{{getTotalamt(dsNewmaterialList.data)
                                        | currency:'INR' }}</span>  -->
                                </div>
        
                            </mat-card>
                        </div>
                    </div>

                    <mat-card>
                        <div class="new-appointment-actions gap-8 mt-12" fxLayout="row" fxLayoutAlign="space-between">
                            
                            <div fxLayout="row wrap" fxLayoutGap="12px grid">
                                <!-- 1st -->
                                <div fxFlex="40%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="Remark"  #Remark
                                        rows="1"
                                        formControlName="Remark" 
                                        [value]="data?.Remark"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().Remark">
                                    </airmid-textbox>
                                </div>
                                <!-- 2nd -->
                                <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="MRPTotalAmount" 
                                        formControlName="MRPTotalAmount" 
                                        [value]="data?.MRPTotalAmount"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().MRPTotalAmount"
                                        [(ngModel)]="vMRPTotalAmount">
                                    </airmid-textbox>
                                </div>
                                <!-- 3rd -->
                                <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="PurTotalAmount" 
                                        formControlName="PurTotalAmount" 
                                        [value]="data?.PurTotalAmount"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().PurTotalAmount"
                                        [(ngModel)]="vPurTotalAmount">
                                    </airmid-textbox>
                                </div>
                                <!-- 4th -->
                                <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                    <airmid-textbox 
                                        label="LandedTotalAmount" 
                                        formControlName="LandedTotalAmount" 
                                        [value]="data?.LandedTotalAmount"
                                        [formGroup]="myForm"
                                        [validations]="getValidationMessages().LandedTotalAmount"
                                        [(ngModel)]="vLandedTotalAmount">
                                    </airmid-textbox>
                                </div>
                            </div>

                            <div class="new-appointment-actions gap-10" fxLayoutAlign="end center">
                                <button class="btn btn-danger-outline" (click)="onClose()">Close</button>
                                <button class="btn btn-primary" (click)="OnSave()">Save</button>
                            </div>
                            
                        </div>
                    </mat-card>

                </div>
            </form>
        </div>
    </div>
</div>