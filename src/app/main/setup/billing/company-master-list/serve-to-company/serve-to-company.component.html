<div class="modal-wrapper grid-container">
  <!-- Modal header -->
  <div class="modal-header accent">
    <div class="modal-header-content">
      <div class="modal-header-title">
        <span [@animate]="{ value: '*', params: { delay: '100ms', x: '-25px' } }">Company Master</span>
      </div>
      <div class="modal-header-right">
        <div class="comman-date-container">

          <div class="close-icon">
            <button mat-icon-button tabIndex="-1" [mat-dialog-close]="true" aria-label="Close dialog"
              matTooltip="Close">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-body">
    <div class="modal-body-container">
      <div class="main-content h-100-p overflow-auto ml-8">
        <div>

          <div class="personal-panel">
            <mat-accordion multi>
              <mat-expansion-panel expanded class="mt-12">
                <mat-expansion-panel-header>

                  <div (click)="$event.stopPropagation()">
                    <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start" class="tab-in-header"
                      (selectedTabChange)="onTabChange($event)">
                      <mat-tab label="Service To Company Detail"></mat-tab>
                      <mat-tab label="Company Wise Service List"></mat-tab>
                      <mat-tab label="Discount Details"></mat-tab>
                      <mat-tab label="Sub Tpa List"></mat-tab>
                    </mat-tab-group>
                  </div>
                </mat-expansion-panel-header>
                <ng-container [ngSwitch]="selectedTabIndex">
                  <div *ngSwitchCase="0">
                    <form [formGroup]="companyForm">

                      <div fxLayout="row wrap" fxLayoutGap="12px grid" style="padding: 10px;">
                        <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="33%">
                          <airmid-textbox label="CompanyName" formControlName="companyName" [formGroup]="companyForm"
                            [validations]="getValidationMessages().companyName" [maxLength]="50"
                            [value]="compobj?.companyName">
                          </airmid-textbox>
                        </div>

                        <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                          <airmid-dropdown label="ClassName" formControlName="ClassId1" [formGroup]="companyForm"
                            (selectionChange)="selectChangemainclass($event)" [value]="compobj?.classId"
                            [validations]="getValidationMessages().ClassId1" [mode]="autocompleteModeclass1">
                          </airmid-dropdown>
                        </div>
                        <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                          <airmid-dropdown label="TariffName" formControlName="TariffId1" [formGroup]="companyForm"
                            [value]="compobj?.traiffId" (selectionChange)="selectChangemainclass($event)"
                            [readonly]="true" [validations]="getValidationMessages().TariffId1"
                            [mode]="autocompleteModetariff1">
                          </airmid-dropdown>
                        </div>
                      </div>


                      <!-- <div fxLayout="row wrap" fxLayoutGap="12px grid">
                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                        
                          <airmid-dropdown label="ServiceName" formControlName="ServiceName" [formGroup]="companyForm"
                            (selectionChange)="selectChangeclass($event)"
                            [validations]="getValidationMessages().compTypeId" [mode]="autocompleteModetypeName">
                          </airmid-dropdown>
                        </div>
                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                          <airmid-dropdown label="ClassName" formControlName="ClassId2" [formGroup]="companyForm"
                            (selectionChange)="selectChangeclass($event)"
                            [validations]="getValidationMessages().ClassId1" [mode]="autocompleteModeclass2">
                          </airmid-dropdown>
                        </div>

                      </div> -->
                    </form>

                    <div class="table-row gap-12" fxLayout="column" fxLayout.gt-sm="row">
                      <div class="table-right" fxFlex="100%" fxFlex.sm="100%" fxFlex.gt-sm="98%">
                        <div fusePerfectScrollbar
                          class="page-layout simple left-sidebar inner-sidebar inner-scroll update-grn mat-form-field-auto"
                          dynamicTableHeight>

                          <mat-table matSort [dataSource]="DSServicedetailMainList" class="airmid-table"
                            [@animateStagger]="{ value: '50' }">

                            <ng-container matColumnDef="ServiceName">
                              <mat-header-cell *matHeaderCellDef mat-sort-header>Service Name</mat-header-cell>
                              <mat-cell *matCellDef="let element" fxShow.gt-sm>{{ element.ServiceName}}</mat-cell>
                            </ng-container>

                            <!-- 
                            <ng-container matColumnDef="ClassName">
                              <mat-header-cell *matHeaderCellDef mat-sort-header>Class Name</mat-header-cell>
                              <mat-cell *matCellDef="let element" fxShow.gt-sm>{{ element.ClassName}}</mat-cell>
                            </ng-container> -->

                            <ng-container matColumnDef="TariffName">
                              <mat-header-cell *matHeaderCellDef mat-sort-header>Tariff Name</mat-header-cell>
                              <mat-cell *matCellDef="let element" fxShow.gt-sm>{{ element.TariffName}}</mat-cell>
                            </ng-container>


                            <!-- <ng-container matColumnDef="qty">
                              <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Qty</mat-header-cell>
                              <mat-cell *matCellDef="let element" fxShow.gt-sm>
                                <mat-form-field appearance="fill">
                                  <input matInput [(ngModel)]="element.qty" OnlyNumber
                                    (keyup)="gettableclassrate(element, $event.value)"
                                    (keypress)="keyPressCharater($event)" />
                                </mat-form-field>
                              </mat-cell>
                            </ng-container> -->


                            <ng-container matColumnDef="classRate">
                              <mat-header-cell *matHeaderCellDef mat-sort-header
                                fxShow.gt-sm>ClassRate</mat-header-cell>
                              <mat-cell *matCellDef="let element" fxShow.gt-sm>
                                <mat-form-field appearance="fill">
                                  <input matInput [(ngModel)]="element.classRate" OnlyNumber
                                    (keyup)="gettableclassrate(element, $event.value)"
                                    (keypress)="keyPressCharater($event)" />
                                </mat-form-field>
                              </mat-cell>
                            </ng-container>

                            <ng-container matColumnDef="checkbox" sticky>
                              <mat-header-cell *matHeaderCellDef mat-sort-header class="w-60">Exclude
                                <span class="material-icons" (click)="getChargesList()">cached</span>
                              </mat-header-cell>
                              <mat-cell *matCellDef="let element" class="w-60">
                                <mat-checkbox aria-label="Checked"
                                  (change)="tableElementChecked($event, element)"></mat-checkbox>
                              </mat-cell>
                            </ng-container>


                            <ng-container matColumnDef="Action" stickyEnd>
                              <mat-header-cell *matHeaderCellDef class="w-80">Action</mat-header-cell>
                              <mat-cell *matCellDef="let element" class="w-80">
                                <button mat-icon-button (click)="maindeleteTableRow(element)" color="warn">
                                  <mat-icon>delete_outline</mat-icon>
                                </button>
                              </mat-cell>
                            </ng-container>


                            <ng-container matColumnDef="loading">
                              <mat-footer-cell *matFooterCellDef colspan="6">loading data...</mat-footer-cell>
                            </ng-container>

                            <ng-container matColumnDef="noData">
                              <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                            </ng-container>


                            <mat-header-row class="accent" *matHeaderRowDef="displayedColumns2;"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: displayedColumns2" class="element"
                              [@animate]="{ value: '*', params: { y: '100%' } }" style="height:50px;"></mat-row>
                            <mat-footer-row *matFooterRowDef="['loading']"
                              [ngClass]="{ hide: DSServicedetailMainList != null }"></mat-footer-row>
                            <mat-footer-row *matFooterRowDef="['noData']"
                              [ngClass]="{ hide: !(DSServicedetailMainList != null && DSServicedetailMainList.data.length == 0) }"></mat-footer-row>


                          </mat-table>
                        </div>
                      </div>
                    </div>

                  </div>
               
                  <div *ngSwitchCase="1">
                    <ng-container [ngSwitch]="selectedTabIndex">
                      <form [formGroup]="searchFormGroup">
                        <mat-card>
                          <mat-card-content class="py-8">

                            <div fxLayout="row wrap" fxLayoutGap="12px 0px grid" fxLayoutAlign="space-between center"
                              class="input-error-hidden">
                              <div class="radio-container">
                                <mat-radio-group aria-label="Select an option" formControlName="regRadio"
                                  name="regRadio" (change)="onChangeRadio($event)">
                                  <mat-radio-button value="Service">Service Discount</mat-radio-button>
                                  <mat-radio-button value="Group">Group Discount</mat-radio-button>
                                  <mat-radio-button value="SubGroup">Sub Group Discount</mat-radio-button>
                                </mat-radio-group>
                              </div>

                            </div>
                          </mat-card-content>
                        </mat-card>
                      </form>
                      <div *ngIf="Regflag==0">
                        <form [formGroup]="servFormGroup">
                          <div fxLayout="row wrap" fxLayoutGap="12px grid" style="padding: 20px;">
                            <div fxFlex="30%" fxFlex.xs="100%" fxFlex.sm="33%">

                              <airmid-dropdown label="ServiceName" formControlName="ServiceName"
                                [formGroup]="servFormGroup" (selectionChange)="selectService($event)"
                                [validations]="getValidationMessages().ServiceName" [mode]="autocompleteModetypeName">
                              </airmid-dropdown>
                            </div>
                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                              <airmid-dropdown label="ClassName" formControlName="ClassId2" [formGroup]="servFormGroup"
                                (selectionChange)="selectdiscservicelist($event)"
                                [validations]="getValidationMessages().ClassId1" [mode]="autocompleteModeclass2">
                              </airmid-dropdown>
                            </div>

                          </div>
                        </form>
                        <div class="table-row gap-12" fxLayout="column" fxLayout.gt-sm="row"
                          style="max-height: 400px; overflow-y: auto;">

                          <div class="table-right" fxFlex="100%" fxFlex.sm="100%" fxFlex.gt-sm="95%">
                            <div fusePerfectScrollbar
                              class="page-layout simple left-sidebar inner-sidebar inner-scroll update-grn mat-form-field-auto"
                              dynamicTableHeight>

                              <mat-table matSort [dataSource]="discServiceList" class="airmid-table"
                                [@animateStagger]="{ value: '50' }">

                                <ng-container matColumnDef="ServiceName">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header>Service Name</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                    element.ServiceName}}</mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="disc">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>
                                    <mat-form-field appearance="fill">
                                      <input matInput [(ngModel)]="element.disc" OnlyNumber
                                        (keyup)="gettableclassrate(element, $event.value)"
                                        (keypress)="keyPressCharater($event)" />
                                    </mat-form-field>
                                  </mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="loading">
                                  <mat-footer-cell *matFooterCellDef colspan="6">loading data...</mat-footer-cell>
                                </ng-container>

                                <ng-container matColumnDef="noData">
                                  <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                                </ng-container>

                                <mat-header-row class="accent"
                                  *matHeaderRowDef="displayedColumnsser; sticky: true"></mat-header-row>
                                <mat-row *matRowDef="let row; columns: displayedColumnsser" class="element"
                                  [@animate]="{ value: '*', params: { y: '100%' } }" style="height:40px;"></mat-row>
                                <mat-footer-row *matFooterRowDef="['loading']"
                                  [ngClass]="{ hide: discServiceList != null }"></mat-footer-row>
                                <mat-footer-row *matFooterRowDef="['noData']"
                                  [ngClass]="{ hide: !(discServiceList != null && discServiceList.data.length == 0) }"></mat-footer-row>
                              </mat-table>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div *ngIf="Regflag==1">

                        <div class="table-row gap-12" fxLayout="column" fxLayout.gt-sm="row"
                          style="max-height: 600px; overflow-y: auto;">

                          <div class="table-right" fxFlex="100%" fxFlex.sm="100%" fxFlex.gt-sm="95%">
                            <div fusePerfectScrollbar
                              class="page-layout simple left-sidebar inner-sidebar inner-scroll update-grn mat-form-field-auto"
                              dynamicTableHeight>

                              <mat-table matSort [dataSource]="discgroupList" class="airmid-table"
                                [@animateStagger]="{ value: '50' }">

                                <ng-container matColumnDef="GroupName">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header>Group Name</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                    element.GroupName}}</mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="TariffName">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header>Tariff Name</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                    element.TariffName}}</mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="disc">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>
                                    <mat-form-field appearance="fill">
                                      <input matInput [(ngModel)]="element.disc" OnlyNumber
                                        (keyup)="gettableclassrate(element, $event.value)"
                                        (keypress)="keyPressCharater($event)" />
                                    </mat-form-field>
                                  </mat-cell>
                                </ng-container>


                                <ng-container matColumnDef="loading">
                                  <mat-footer-cell *matFooterCellDef colspan="6">loading data...</mat-footer-cell>
                                </ng-container>

                                <ng-container matColumnDef="noData">
                                  <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                                </ng-container>

                                <mat-header-row class="accent"
                                  *matHeaderRowDef="displayedColumnsgrp; sticky: true"></mat-header-row>
                                <mat-row *matRowDef="let row; columns: displayedColumnsgrp" class="element"
                                  [@animate]="{ value: '*', params: { y: '100%' } }" style="height:40px;"></mat-row>
                                <mat-footer-row *matFooterRowDef="['loading']"
                                  [ngClass]="{ hide: discgroupList != null }"></mat-footer-row>
                                <mat-footer-row *matFooterRowDef="['noData']"
                                  [ngClass]="{ hide: !(discgroupList != null && discgroupList.data.length == 0) }"></mat-footer-row>

                              </mat-table>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div *ngIf="Regflag==2">

                        <div class="table-row gap-12" fxLayout="column" fxLayout.gt-sm="row"
                          style="max-height: 600px; overflow-y: auto;">

                          <div class="table-right" fxFlex="100%" fxFlex.sm="100%" fxFlex.gt-sm="95%">
                          <div class="airmid-table-container pt-12">

                              <mat-table matSort [dataSource]="discsubgroupList" [@animateStagger]="{ value: '50' }"
                                class="airmid-table">
                                <ng-container matColumnDef="SubGroupName">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header>SubGroup Name</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                    element.SubGroupName}}</mat-cell>
                                </ng-container>

                                <ng-container matColumnDef="TariffName">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header>Tariff Name</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                    element.TariffName}}</mat-cell>
                                </ng-container>


                                <ng-container matColumnDef="disc">
                                  <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc</mat-header-cell>
                                  <mat-cell *matCellDef="let element" fxShow.gt-sm>
                                    <mat-form-field appearance="fill">
                                      <input matInput [(ngModel)]="element.disc" OnlyNumber
                                        (keyup)="gettableclassrate(element, $event.value)"
                                        (keypress)="keyPressCharater($event)" />
                                    </mat-form-field>
                                  </mat-cell>
                                </ng-container>


                                <ng-container matColumnDef="loading">
                                  <mat-footer-cell *matFooterCellDef colspan="6">loading data...</mat-footer-cell>
                                </ng-container>

                                <ng-container matColumnDef="noData">
                                  <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                                </ng-container>


                                <mat-header-row class="accent min-width-1100"
                                  *matHeaderRowDef="displayedColumnssubgrp; sticky: true"></mat-header-row>
                                <mat-row *matRowDef="let row; columns: displayedColumnssubgrp"
                                  class="element min-width-1100"
                                  [@animate]="{ value: '*', params: { y: '100%' } }"></mat-row>
                                <mat-footer-row *matFooterRowDef="['loading']"
                                  [ngClass]="{ hide: dataSourceeducation != null }"></mat-footer-row>
                                <mat-footer-row *matFooterRowDef="['noData']"
                                  [ngClass]="{ hide: !(discsubgroupList != null && discsubgroupList.data.length == 0) }"></mat-footer-row>
                              </mat-table>
                            </div>
                          </div>
                        </div>
                      </div>


                    </ng-container>
                  </div>
                  <div *ngSwitchCase="2">
                    <ng-container [ngSwitch]="selectedTabIndex">

                      <div class="table-row gap-12" fxLayout="column" fxLayout.gt-sm="row">

                        <div class="table-right" fxFlex="100%" fxFlex.sm="100%" fxFlex.gt-sm="90%"
                          style="max-height: 700px; overflow-y: auto;">

                          <div fusePerfectScrollbar
                            class="page-layout simple left-sidebar inner-sidebar inner-scroll update0-grn mat-form-field-auto">

                            <mat-table matSort [dataSource]="subtpaList" class="airmid-table"
                              [@animateStagger]="{ value: '50' }">

                              <ng-container matColumnDef="TypeName">
                                <mat-header-cell *matHeaderCellDef mat-sort-header>Service Name</mat-header-cell>
                                <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                  element.TypeName}}</mat-cell>
                              </ng-container>

                              <ng-container matColumnDef="CompanyName">
                                <mat-header-cell *matHeaderCellDef mat-sort-header>Company Name</mat-header-cell>
                                <mat-cell *matCellDef="let element" fxShow.gt-sm>{{
                                  element.CompanyName}}</mat-cell>
                              </ng-container>

                              <ng-container matColumnDef="Action" stickyEnd>
                                <mat-header-cell *matHeaderCellDef class="w-80">Action</mat-header-cell>
                                <mat-cell *matCellDef="let element" class="w-80">
                                  <button mat-icon-button (click)="deleteTableRow(element)" color="warn">
                                    <mat-icon>delete_outline</mat-icon>
                                  </button>
                                </mat-cell>
                              </ng-container>


                              <ng-container matColumnDef="loading">
                                <mat-footer-cell *matFooterCellDef colspan="6">loading data...</mat-footer-cell>
                              </ng-container>

                              <ng-container matColumnDef="noData">
                                <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                              </ng-container>

                              <mat-header-row class="accent"
                                *matHeaderRowDef="displayedColumnsubtpa; sticky: true"></mat-header-row>
                              <mat-row *matRowDef="let row; columns: displayedColumnsubtpa" class="element"
                                [@animate]="{ value: '*', params: { y: '100%' } }"></mat-row>
                              <mat-footer-row *matFooterRowDef="['loading']"
                                [ngClass]="{ hide: subtpaList != null }"></mat-footer-row>
                              <mat-footer-row *matFooterRowDef="['noData']"
                                [ngClass]="{ hide: !(subtpaList != null && subtpaList.data.length == 0) }"></mat-footer-row>
                            </mat-table>
                          </div>
                        </div>
                      </div>

                    </ng-container>
                  </div>
                </ng-container>
              </mat-expansion-panel>

            </mat-accordion>
          </div>
        </div>

      </div>

    </div>
  </div>

  <div class="modal-footer">
    <div class="footer-navigation-container">
      <div class="modal-footer-buttons">
        <button type="button" class="btn btn-danger-outline" (click)="onClear(false)">Close</button>
        <button type="button" class="btn btn-primary" (click)="onSubmit()">Save</button>
      </div>
    </div>
  </div>
</div>