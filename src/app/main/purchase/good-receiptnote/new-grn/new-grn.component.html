<!-- NEW -->
<div class="modal-page page-layout inner-scroll">
  <div class="modal-wrapper grid-container">
    <!-- Modal header -->
    <div class="modal-header accent">
      <div class="modal-header-content">
        <div class="modal-header-title">
          <span [@animate]="{ value: '*', params: { delay: '100ms', x: '-25px' } }">GRN</span>
        </div>
        <div class="modal-header-right">
          <div class="comman-date-container">
            <app-common-date [screenFrom]="'OP-billing'" (dateTimeEventEmitter)="getDateTime($event)"></app-common-date>
            <div class="close-icon">
              <button mat-icon-button tabIndex="-1" [mat-dialog-close]="true" aria-label="Close dialog" matTooltip="Close">
                <mat-icon>close</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal body -->
    <div class="modal-body">
      <div class="modal-body-container">
        <div fxLayout="column" class="h-100-p">
          <mat-accordion>
            <mat-expansion-panel expanded>
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <div class="panel-title" fxLayout="row" fxLayoutAlign="space-between center">
                    <span>GRN Details</span>
                  </div>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <div fxLayout="column" fxLayout="row" fxLayoutAlign="start none">
                <form [formGroup]="_GRNList.userFormGroup" class="pt-4" style="overflow: auto">
                  <div fxLayout="row" class="gap-4">
                    <!-- <div>
                      <form [formGroup]="_GRNList.GRNStoreForm" class="p-0">
                        <mat-form-field appearance="outline">
                          <mat-select formControlName="StoreId" name="StoreId">
                            <mat-option></mat-option>
                            <mat-option *ngFor="let m of StoreList" [value]="m">
                              {{ m.StoreName }}
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </form>
                    </div> -->

                    <airmid-dropdown
                      label="Supplier Name | Code"
                      formControlName="SupplierId"
                      [formGroup]="_GRNList.userFormGroup"
                      [validations]="getValidationMessages().supplierId"
                      [mode]="dropdownMode.supplierMaster"
                      (selectionChange)="selectChangeSupplier($event)"
                    ></airmid-dropdown>

                    <airmid-textbox
                      fxFlex="10%"
                      label="Contact Persion"
                      formControlName="Contact"
                      [(ngModel)]="vContact"
                      [formGroup]="_GRNList.userFormGroup"
                      [readonly]="true"
                      [disabled]="true"
                    ></airmid-textbox>

                    <airmid-textbox fxFlex="10%" label="Mobile" formControlName="Mobile" [(ngModel)]="vMobile" [formGroup]="_GRNList.userFormGroup" [readonly]="true"></airmid-textbox>

                    <airmid-datepicker fxFlex="10%" [formGroup]="_GRNList.userFormGroup" formControlName="DateOfInvoice" [label]="'Invoice Date'" [(ngModel)]="registerObj.InvDate"></airmid-datepicker>

                    <airmid-textbox
                      fxFlex="10%"
                      label="Invoice No"
                      formControlName="InvoiceNo"
                      [(ngModel)]="registerObj.InvoiceNo"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="Invoice No"
                      [validations]="getValidationMessages().invoiceNo"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="10%"
                      label="Gate Entry No"
                      formControlName="InvoiceNo"
                      [(ngModel)]="registerObj.GrnNumber"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="GateEntryNo"
                      [validations]="getValidationMessages().gateEntryNo"
                    ></airmid-textbox>

                    <airmid-datepicker
                      fxFlex="10%"
                      [formGroup]="_GRNList.userFormGroup"
                      formControlName="PaymentDate"
                      [label]="'Payment due date'"
                      [(ngModel)]="registerObj.PaymentDate"
                    ></airmid-datepicker>

                    <airmid-dropdown
                      fxFlex="10%"
                      label="Select GST Type"
                      formControlName="GSTType"
                      [formGroup]="_GRNList.userFormGroup"
                      [validations]="getValidationMessages().supplierId"
                      (selectionChange)="finalCalculation()"
                      [mode]="dropdownMode.gstCalcType"
                    ></airmid-dropdown>

                    <div fxLayout="row" fxFlex="15%" class="ml-8">
                      <mat-radio-group [(ngModel)]="vGrntypechecked" formControlName="GRNType" fxLayout="column" class="gap-4">
                        <mat-radio-button [value]="1">Direct Purchase</mat-radio-button>
                        <mat-radio-button [value]="0" (click)="PurchaseOrderList()">Purchase Orders</mat-radio-button>
                      </mat-radio-group>

                      <mat-radio-group [(ngModel)]="vCahchecked" formControlName="PaymentType" fxLayout="column" class="gap-4">
                        <mat-radio-button [value]="1">Cash</mat-radio-button>
                        <mat-radio-button [value]="0">Credit</mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                  <div fxLayout="row" class="gap-4">
                    <input type="hidden" name="PurchaseId" [(ngModel)]="vPurchaseId" formControlName="PurchaseId" />
                    <input type="hidden" name="poBalQty" [(ngModel)]="vpoBalQty" formControlName="poBalQty" />

                    <airmid-autocomplete
                      label="Item Name (enter 2 char)"
                      [formGroup]="_GRNList.userFormGroup"
                      formControlName="ItemName"
                      placeholderText="Item Name (enter 2 char)"
                      fxFlex
                      ApiUrl="ItemMaster/GetItemListForGRNOrPO?StoreId=2&ItemName="
                      (selectionChange)="getSelectedItem($event)"
                      TextField="formattedText"
                    ></airmid-autocomplete>

                    <airmid-textbox fxFlex="5%" label="UOM" formControlName="UOM" [(ngModel)]="vUOM" [formGroup]="_GRNList.userFormGroup" placeholder="UOM" [readonly]="true"></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="Packing"
                      formControlName="ConversionFactor"
                      [(ngModel)]="vConversionFactor"
                      [formGroup]="_GRNList.userFormGroup"
                      [readonly]="!(vItemName && vItemName.ItemName)"
                      (keyup)="calculateTotalamt()"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="Batch No"
                      formControlName="ConversionFactor"
                      [(ngModel)]="vBatchNo"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="BatchNo"
                      [readonly]="!(vItemName && vItemName.ItemName)"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="MMYYYY"
                      formControlName="ExpDatess"
                      [(ngModel)]="vlastDay"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="mmyyyy"
                      [readonly]="!(vItemName && vItemName.ItemName)"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="4%"
                      label="Qty"
                      formControlName="Qty"
                      [(ngModel)]="vQty"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="Qty"
                      [readonly]="!(vItemName && vItemName.ItemName)"
                      (keyup)="calculateTotalamt()"
                      type="number"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="4%"
                      label="Free Qty"
                      formControlName="FreeQty"
                      [(ngModel)]="vFreeQty"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="FreeQty"
                      [readonly]="!(vItemName && vItemName.ItemName)"
                      type="number"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="MRP"
                      formControlName="MRP"
                      [(ngModel)]="vMRP"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="MRP"
                      type="number"
                      [validations]="getValidationMessages().mrp"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="Rate"
                      formControlName="MRP"
                      [(ngModel)]="vRate"
                      [formGroup]="_GRNList.userFormGroup"
                      placeholder="Rate"
                      type="number"
                      (keyup)="OnchekPurchaserateValidation()"
                      [validations]="getValidationMessages().rate"
                    ></airmid-textbox>

                    <airmid-textbox fxFlex="5%" label="Total Amount" formControlName="TotalAmount" [(ngModel)]="vTotalAmount" [formGroup]="_GRNList.userFormGroup" [readonly]="true"></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="Disc1 %"
                      formControlName="Disc"
                      [(ngModel)]="vDisc"
                      [formGroup]="_GRNList.userFormGroup"
                      type="number"
                      (keyup)="calculateDiscperAmount()"
                      [validations]="getValidationMessages().discPer1"
                    ></airmid-textbox>

                    <airmid-textbox
                      fxFlex="5%"
                      label="Disc2 %"
                      formControlName="Disc2"
                      [(ngModel)]="vDisc2"
                      [formGroup]="_GRNList.userFormGroup"
                      type="number"
                      (keyup)="calculateDiscper2Amt()"
                      [validations]="getValidationMessages().discPer2"
                    ></airmid-textbox>

                    <airmid-textbox fxFlex="5%" label="GST" formControlName="GST" [(ngModel)]="vGST" [formGroup]="_GRNList.userFormGroup" type="number" [readonly]="true"></airmid-textbox>

                    <airmid-textbox fxFlex="4%" label="CGST" formControlName="CGST" [(ngModel)]="vCGST" [formGroup]="_GRNList.userFormGroup" type="number" [readonly]="true"></airmid-textbox>

                    <airmid-textbox fxFlex="4%" label="SGST" formControlName="SGST" [(ngModel)]="vSGST" [formGroup]="_GRNList.userFormGroup" type="number" [readonly]="true"></airmid-textbox>

                    <airmid-textbox fxFlex="4%" label="IGST" formControlName="IGST" [(ngModel)]="vIGST" [formGroup]="_GRNList.userFormGroup" type="number" [readonly]="true"></airmid-textbox>

                    <airmid-textbox fxFlex="5%" label="Net Amount" formControlName="NetAmount" [(ngModel)]="vNetAmount" [formGroup]="_GRNList.userFormGroup" [readonly]="true"></airmid-textbox>
                    <div matTooltip="Select All Value to enable this button!!">
                      <button type="button" class="btn btn-primary btn-with-icon py-8" (click)="onAdd()" [disabled]="!vRate" #addbutton id="btnAdd">
                        <mat-icon>add</mat-icon>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
          <div class="airmid-table-container py-12" fxFlex>
            <mat-table #table class="airmid-table table3 max-h-700" matSort [dataSource]="dsItemNameList" [@animateStagger]="{ value: '50' }">
              <ng-container matColumnDef="buttons" stickyEnd>
                <mat-header-cell *matHeaderCellDef>Action</mat-header-cell>
                <mat-cell *matCellDef="let row">
                  <button mat-icon-button (click)="deleteTableRow(row)" color="warn">
                    <mat-icon>delete_outline</mat-icon>
                  </button>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="SrNo">
                <mat-header-cell *matHeaderCellDef mat-sort-header>SrNo</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index">
                  <span>{{ index + 1 }}</span>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="ItemName">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxHide fxShow.gt-sm class="w-200">ItemName</mat-header-cell>
                <mat-cell *matCellDef="let contact; let i = index" fxShow.gt-sm class="w-200">
                  {{ contact.ItemName + ' ' + i }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="ConversionFactor">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Packing</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.ConversionFactor"
                      (keyup)="getCellCalculation(contact, contact.ConversionFactor)"
                      step="0.1"
                      type="text"
                      autocomplete="off"
                      OnlyNumber
                      [disabled]="contact.IsVerifiedUserId > 0"
                      [id]="'Packing_' + index"
                      (keydown.arrowdown)="setFocus('Packing_' + (index + 1))"
                      (keydown.arrowup)="setFocus('Packing_' + (index - 1))"
                      (keypress)="keyPressAlphanumeric($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="UOMId">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>UOM</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.UOMId }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="HSNCode">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>HSNCode</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.HSNCode }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="BatchNo">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>BatchNo</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.BatchNo"
                      [disabled]="contact.IsVerifiedUserId > 0"
                      [id]="'BatchNo_' + index"
                      (keydown.arrowdown)="setFocus('BatchNo_' + (index + 1))"
                      (keydown.arrowup)="setFocus('BatchNo_' + (index - 1))"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="ExpDate">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>ExpDate</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      #inputField
                      (keyup)="CellcalculateLastDay(contact, inputField.value)"
                      [(ngModel)]="contact.BatchExpDate"
                      placeholder="mmyyyy"
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keypress)="keyPressAlphanumeric($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Qty">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm class="w-80">Qty</mat-header-cell>
                <mat-cell class="w-80" *matCellDef="let contact" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.ReceiveQty"
                      type="text"
                      OnlyNumber
                      [id]="'Qty_' + index"
                      (keyup)="getCellCalculation(contact, contact.ReceiveQty)"
                      (keypress)="keyPressAlphanumeric($event)"
                      (keydown.arrowdown)="setFocus('Qty_' + (index + 1))"
                      (keydown.arrowup)="setFocus('Qty_' + (index - 1))"
                      [disabled]="contact.IsVerifiedUserId > 0"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="FreeQty">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>FreeQty</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm [(ngModel)]="contact.FreeQty">
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.FreeQty"
                      type="text"
                      OnlyNumber
                      [id]="'FreeQty_' + index"
                      (keyup)="getCellCalculation(contact, contact.FreeQty)"
                      (keypress)="keyPressAlphanumeric($event)"
                      (keydown.arrowdown)="setFocus('FreeQty_' + (index + 1))"
                      (keydown.arrowup)="setFocus('FreeQty_' + (index - 1))"
                      [disabled]="contact.IsVerifiedUserId > 0"
                    />
                  </mat-form-field>
                  <!-- {{contact.FreeQty }} -->
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="TotalQty">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>TotalQty</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.TotalQty }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="MRP">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>MRP(Strip)</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.MRP"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      [id]="'MRP_' + index"
                      autocomplete="off"
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keydown.arrowdown)="setFocus('MRP_' + (index + 1))"
                      (keydown.arrowup)="setFocus('MRP_' + (index - 1))"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                  <!-- {{contact.MRP  | number:'1.2-2' }} -->
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Rate">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Rate</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      type="number"
                      [(ngModel)]="contact.Rate"
                      step="0.1"
                      [id]="'Rate_' + index"
                      type="text"
                      autocomplete="off"
                      OnlyNumber
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.Rate)"
                      (keydown.arrowdown)="setFocus('Rate_' + (index + 1))"
                      (keydown.arrowup)="setFocus('Rate_' + (index - 1))"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="TotalAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>TotalAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.TotalAmount | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Disc">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc%</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.DiscPercentage"
                      [id]="'DiscPer_' + index"
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.DiscPercentage)"
                      (keydown.arrowdown)="setFocus('DiscPer_' + (index + 1))"
                      (keydown.arrowup)="setFocus('DiscPer_' + (index - 1))"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      autocomplete="off"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="DisAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>DisAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.DiscAmount | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Disc2">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc2%</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.DiscPer2"
                      [id]="'DiscPer2_' + index"
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.DiscPer2)"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      autocomplete="off"
                      (keydown.arrowdown)="setFocus('DiscPer2_' + (index + 1))"
                      (keydown.arrowup)="setFocus('DiscPer2_' + (index - 1))"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <!-- <ng-container matColumnDef="Disc2">
                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>
                                        Disc2%</mat-header-cell>
                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                                        {{contact.DiscPer2 }}
                                    </mat-cell>
                                </ng-container> -->

              <ng-container matColumnDef="DisAmount2">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>DisAmt2</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.DiscAmt2 | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="GST">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>GST</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.VatPercentage }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="GSTAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>GSTAmount</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.VatAmount | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="CGST">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>CGST</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.CGSTPer"
                      [id]="'CGSTPer_' + index"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.CGSTPer)"
                      (keydown.arrowdown)="setFocus('CGSTPer_' + (index + 1))"
                      (keydown.arrowup)="setFocus('CGSTPer_' + (index - 1))"
                      autocomplete="off"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="CGSTAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>CGSTAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.CGSTAmt | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="SGST">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>SGST</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.SGSTPer"
                      [id]="'SGSTPer_' + index"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.SGSTPer)"
                      (keydown.arrowdown)="setFocus('SGSTPer_' + (index + 1))"
                      (keydown.arrowup)="setFocus('SGSTPer_' + (index - 1))"
                      autocomplete="off"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="SGSTAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>SGSTAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.SGSTAmt | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="IGST">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>IGST</mat-header-cell>
                <mat-cell *matCellDef="let contact; let index = index" fxShow.gt-sm>
                  <mat-form-field appearance="fill">
                    <input
                      matInput
                      [(ngModel)]="contact.IGSTPer"
                      [id]="'IGSTPer_' + index"
                      step="0.1"
                      type="text"
                      OnlyNumber
                      [disabled]="contact.IsVerifiedUserId > 0"
                      (keyup)="getCellCalculation(contact, contact.IGSTPer)"
                      autocomplete="off"
                      (keydown.arrowdown)="setFocus('IGSTPer_' + (index + 1))"
                      (keydown.arrowup)="setFocus('IGSTPer_' + (index - 1))"
                      (keypress)="keyPressCharater($event)"
                    />
                  </mat-form-field>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="IGSTAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>IGSTAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.IGSTAmt | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="NetAmount">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>NetAmt</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.NetAmount | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="poId">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>PO No</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.PurchaseId }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="purDetID">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>purDetID</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.PurDetId }}
                </mat-cell>
              </ng-container>

              <!-- <ng-container matColumnDef="isClosed">
                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>
                                        isClosed</mat-header-cell>
                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                                        {{contact.IsClosed }}
                                    </mat-cell>
                                </ng-container> -->

              <ng-container matColumnDef="poBalQty">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>POBalQty</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.POBalQty }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="poQty">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>PO Qty</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.POQty }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="landedRate">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>landedRate</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.LandedRate | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="purUnitRate">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Unit Rate</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.PurUnitRate | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="purUnitRateWF">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Unit Rate WF</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.PurUnitRateWF | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="UnitMRP">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>UnitMRP</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.UnitMRP | number : '1.2-2' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="IsVerifiedUserId">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>IsVerifiedUserId</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.IsVerifiedUserId }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="Status">
                <mat-header-cell *matHeaderCellDef fxShow.gt-sm style="color: white">Verify</mat-header-cell>
                <mat-cell *matCellDef="let contact">
                  <mat-icon *ngIf="contact.IsVerifiedUserId" matTooltip="Verified" class="pill green-600 s-16">circle</mat-icon>
                  <mat-icon *ngIf="!contact.IsVerifiedUserId" matTooltip="Pending" class="pill red-600 s-16">circle</mat-icon>
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="IsVerified">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>IsVerified</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.IsVerified }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="IsVerifiedDatetime">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>IsVerifiedDatetime</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.IsVerifiedDatetime | date : 'dd/MM/YYYY' }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="stockid">
                <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>StockId</mat-header-cell>
                <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                  {{ contact.StkID }}
                </mat-cell>
              </ng-container>

              <ng-container matColumnDef="loading">
                <mat-header-cell *matFooterCellDef colspan="6" style="display: none"></mat-header-cell>
              </ng-container>

              <ng-container matColumnDef="noData">
                <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
              </ng-container>

              <mat-header-row class="accent min-width-4000" *matHeaderRowDef="displayedColumns2; sticky: true"></mat-header-row>
              <mat-row
                *matRowDef="let contact; columns: displayedColumns2; let i = index"
                [ngClass]="{ highlight: selectedRowIndex == i }"
                (click)="highlight(i)"
                tabindex="999"
                (keydown.arrowdown)="arrowDownEvent()"
                (keydown.arrowup)="arrowUpEvent()"
                class="contact min-width-4000"
                [@animate]="{ value: '*', params: { y: '100%' } }"
                appHighlight
              ></mat-row>
              <mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{ hide: !(sIsLoading == 'loading-data') }"></mat-footer-row>
              <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(dsTest != null && dsTest.data.length == 0) }"></mat-footer-row>
            </mat-table>
          </div>
          <mat-accordion>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>Total Amount Summary</mat-panel-title>
              </mat-expansion-panel-header>
              <form [formGroup]="_GRNList.GRNFinalForm">
                <div fxLayout="column" fxLayout.gt-xs="row" class="gap-12">
                  <div fxFlex fxFlex.gt-xs="40%" fxFlex.xs="100%" class="airmid-table-container">
                    <mat-table #table class="airmid-table table4 h-200" matSort [dataSource]="dsLastThreeItemList">
                      <ng-container matColumnDef="SupplierName">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm class="w-200">SupplierName</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-200">
                          <span>{{ contact.SupplierName }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="ReceiveQty">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>R_Qty</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.ReceiveQty }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="FreeQty">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>F_Qty</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.FreeQty }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="MRP">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>MRP</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.MRP }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="Rate">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Rate</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.Rate }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="discpercentage">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.discpercentage }}%</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="DiscAmount">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>DiscAmt</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.DiscAmount }}</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="VatPercentage">
                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Vat</mat-header-cell>
                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                          <span>{{ contact.VatPercentage }}%</span>
                        </mat-cell>
                      </ng-container>

                      <ng-container matColumnDef="noData">
                        <mat-footer-cell *matFooterCellDef colspan="6">no data found...</mat-footer-cell>
                      </ng-container>
                      <mat-header-row class="min-width-700 accent" *matHeaderRowDef="displayedColumns3; sticky: true"></mat-header-row>
                      <mat-row *matRowDef="let contact; columns: displayedColumns3" class="min-width-700 contact" [@animate]="{ value: '*', params: { y: '100%' } }" appHighlight></mat-row>

                      <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(dsLastThreeItemList != null && dsLastThreeItemList.data.length == 0) }"></mat-footer-row>
                    </mat-table>
                  </div>
                  <div fxFlex fxFlex.gt-xs="60%" fxFlex.xs="100%">
                    <div fxLayout="column" fxLayoutGap="6px">
                      <div fxLayout="row" class="gap-4">
                        <span class="net-amt-mat-label" style="font-weight: bold; padding-bottom: 8px">No Of Item:</span>
                        &nbsp;
                        <!-- <span class="net-amt-value"
                                                        style="margin-left:10px;font-weight:bolder;color: blue;">{{dsItemNameList.data.length}}</span>&nbsp;&nbsp;&nbsp; -->

                        <span class="net-amt-mat-label" style="font-weight: bold; margin-left: 20px">CGST Amt:</span>
                        &nbsp;
                        <span class="net-amt-value text-primary" style="margin-left: 10px; font-weight: bolder">{{ getCGSTAmt(dsItemNameList.data) | currency : 'INR' }}</span>
                        &nbsp;&nbsp;&nbsp;

                        <span class="net-amt-mat-label" style="font-weight: bold; margin-left: 20px">SGST Amt:</span>
                        &nbsp;
                        <span class="net-amt-value text-primary" style="margin-left: 10px; font-weight: bolder">{{ getSGSTAmt(dsItemNameList.data) | currency : 'INR' }}</span>
                        &nbsp;&nbsp;&nbsp;

                        <span class="net-amt-mat-label" style="font-weight: bold; margin-left: 20px">IGST Amt:</span>
                        &nbsp;
                        <span class="net-amt-value text-primary" style="margin-left: 10px; font-weight: bolder">{{ getIGSTAmt(dsItemNameList.data) | currency : 'INR' }}</span>
                        &nbsp;&nbsp;&nbsp;

                        <span class="net-amt-mat-label" style="font-weight: bold; margin-left: 20px">Total Amount:</span>
                        &nbsp;
                        <span class="net-amt-value text-primary" style="margin-left: 10px; font-weight: bolder">{{ getTotalAmt(dsItemNameList.data) | currency : 'INR' }}</span>
                      </div>
                      <div fxLayout="row" class="gap-4">
                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Remark</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="Remark"
                            #Remark
                            type="text"
                            [(ngModel)]="registerObj.Remark"
                            (keydown)="onEnterRemark($event)"
                            (keydown.enter)="focusNextService()"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Received By</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="ReceivedBy"
                            type="text"
                            #ReceivedBy
                            [(ngModel)]="registerObj.ReceivedBy"
                            (keydown)="onEnterReceivedBy($event)"
                            required
                            (keyup)="Setsave()"
                            (keydown.enter)="focusNextService()"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Debit Amt</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="DebitAmount"
                            #DebitAmount
                            [(ngModel)]="registerObj.DebitNote"
                            type="number"
                            (keydown)="onEnterDebitAmount($event)"
                            (keydown.enter)="focusNextService()"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Credit Amt</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="CreditAmount"
                            #CreditAmount
                            [(ngModel)]="registerObj.CreditNote"
                            type="number"
                            (keydown)="onEnterCreditAmount($event)"
                            (keydown.enter)="focusNextService()"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Other Charges</mat-label>
                          <input matInput placeholder="Placeholder" formControlName="OtherCharge" #OtherCharge [(ngModel)]="registerObj.OtherCharge" (keydown)="onEnterOtherCharges($event)" />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Eway BillNo</mat-label>
                          <input matInput placeholder="Placeholder" formControlName="EwayBillNo" [(ngModel)]="registerObj.EwayBillNo" (keydown)="onEnterEwayBillNo($event)" #EwayBillNo />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>EwayBill date</mat-label>
                          <input name="EwalBillDate" matInput [matDatepicker]="picker9" formControllName="EwalBillDate" [(ngModel)]="registerObj.EwayBillDate" />
                          <mat-datepicker-toggle matSuffix [for]="picker9"></mat-datepicker-toggle>
                          <mat-datepicker #picker9></mat-datepicker>
                        </mat-form-field>
                      </div>
                      <div fxLayout="row" class="gap-4">
                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Total Amount</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="TotalAmt"
                            [(ngModel)]="vTotalFinalAmount"
                            #DiscAmount
                            type="number"
                            [(ngModel)]="registerObj.TotalAmount"
                            readonly
                            (keydown)="onEnterDiscAmount($event)"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>DiscAmt</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="DiscAmount"
                            [(ngModel)]="vFinalDisAmount"
                            #DiscAmount
                            type="number"
                            [(ngModel)]="registerObj.TotalDiscAmount"
                            readonly
                            (keydown)="onEnterDiscAmount($event)"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>DiscAmt2</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="DiscAmount2"
                            [(ngModel)]="vFinalDisAmount2"
                            #DiscAmount1
                            type="number"
                            readonly
                            (keydown)="onEnterDiscAmount($event)"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>GST Amt</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="VatAmount"
                            [(ngModel)]="vFinalVatAmount"
                            #VatAmount
                            [(ngModel)]="registerObj.totalVATAmount"
                            readonly
                            (keydown)="onEnterVatAmount($event)"
                            type="number"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Net Pay Amt</mat-label>
                          <input
                            matInput
                            placeholder="Placeholder"
                            formControlName="NetPayamt"
                            type="number"
                            readonly
                            [(ngModel)]="vFinalNetAmount"
                            [(ngModel)]="registerObj.NetAmount"
                            #NetPayamt
                            (keydown)="onEnterNetPayamt($event)"
                          />
                        </mat-form-field>

                        <mat-form-field appearance="outline" fxFlex>
                          <mat-label>Rounding Amt</mat-label>
                          <input matInput placeholder="Placeholder" formControlName="RoundingAmt" #RoundingAmt [(ngModel)]="vDiffNetRoundAmt" (keyup)="AutoRoundingAmt()" />
                        </mat-form-field>
                      </div>
                      <!-- <div>
                                                    <span class="h2">
                                                        <marquee>Expiry Date</marquee>
                                                    </span>
                                                </div> -->
                    </div>
                  </div>
                </div>
              </form>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
      </div>
    </div>
    <!-- Modal footer -->
    <div class="modal-footer">
      <div class="footer-navigation-container">
        <div class="modal-footer-buttons">
          <button class="btn btn-primary-outline" (click)="OnAddItem()">Add Item</button>
          <button class="btn btn-primary-outline" (click)="OnAddSupplier()">Add Supplier</button>
          <button class="btn btn-danger-outline" (click)="OnReset()">Reset</button>
          <button type="button" class="btn btn-primary" [disabled]="Savebtn" (click)="OnSave()">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>
