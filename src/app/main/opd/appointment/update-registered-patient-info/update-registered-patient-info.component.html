<div class="simple page-layout inner-scroll ,inner-sidebar ,left-sidebar" fusePerfectScrollbar>
    <mat-toolbar class="accent" style="height: 40px;width: 100%;justify-content: space-between;">
        <div fxLayout="row" fxLayoutAlign="start center">
            <button mat-icon-button class="sidebar-toggle mr-12" style="color: white;">
                <mat-icon>menu</mat-icon>
            </button>
            <button mat-icon-button class="logo-icon mr-16" [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}"
                style="color: white;">
                <mat-icon>account_box</mat-icon>
            </button>
            <span class="logo-text h1" [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}" style="color: white;">
             Update Registered Patient
            </span> 
        </div>
        <div fxLayout="row" fxLayoutALign="end start">
            <!-- <app-common-date [screenFrom]="screenFromString" (dateTimeEventEmitter)="getDateTime($event)">
            </app-common-date> -->
            <button mat-icon-button tabIndex="-1" (click)="onClose()" aria-label="Close dialog">
                <mat-icon>close</mat-icon>
            </button>
        </div> 
    </mat-toolbar>
    
    <div class="content">
        <div class="center p-12 pb-56" style="border-radius: 4px;">
            <div class="content-card">
               
                        <div fxLayout="column" class="new-appointment-section">
                            <div fxLayout="row" style="width: 100%;">
                                <div fxFlex fxFlex.gt-sm fxLayout="column"   
                                    class="newappointment-body">  
                                    
                                    <div class="personal-panel">
                                        <mat-accordion multi>
                                            <mat-expansion-panel expanded>
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        <div class="panel-title" fxLayout="row" fxLayoutAlign="space-between center"
                                                            fxFlex="65%" fxFlex.lt-md="100%">
                                                            <span>Personal Information </span>
                                                            <!-- <span>
                                                                {{RegOrPhoneflag}}
                                                                <mat-icon style="margin-left:10px;"
                                                                    *ngIf="vPhoneFlage">settings_phone</mat-icon>
                                                            </span> -->
                                                        </div>
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <form [formGroup]="personalFormGroup" class="mat-form-field-100">
                                                    <div fxFlex="100" fxLayout="row wrap" fxLayoutGap="12px grid">
            
                                                        <div fxFlex="85%" fxFlex.xs="100%" fxFlex.sm="80%" fxLayout="row wrap"
                                                            fxLayoutGap="12px grid">
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Prefix</mat-label>
                                                                    <input matAutocompletePosition="below" type="text"
                                                                        placeholder="Select Prefix" matInput
                                                                        (keydown)="onEnterprefix($event,vPrefixID.PrefixID)"
                                                                        formControlName="PrefixID" [matAutocomplete]="autoPrefix"
                                                                        [(ngModel)]="vPrefixID" required>
                                                                    <span matSuffix style="display: flex;">
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('PrefixID').setValue(''); isPrefixSelected = false;">close</mat-icon>
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('PrefixID').setValue(''); isPrefixSelected = false;">search</mat-icon>
                                                                    </span>
                                                                    <mat-autocomplete #autoPrefix="matAutocomplete"
                                                                        [displayWith]="getOptionTextPrefix">
                                                                        <mat-option
                                                                            *ngFor="let option of filteredOptionsPrefix | async"
                                                                            [value]="option"
                                                                            (onSelectionChange)="onChangeGenderList(option)">
                                                                            {{option.PrefixName}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>First Name</mat-label>
                                                                    <input name="FirstName" formControlName="FirstName"
                                                                        placeholder="First Name" matInput required type="text"
                                                                        [(ngModel)]="registerObj.FirstName" #fname
                                                                        (keydown)="onEnterfname($event)">
                                                                    <mat-error
                                                                        *ngIf="personalFormGroup.get('FirstName').invalid && personalFormGroup.get('FirstName').touched">
                                                                        First Name is required Enter only
                                                                        Alphabets</mat-error>
                                                                </mat-form-field>
            
            
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Middle Name</mat-label>
                                                                    <input name="MiddleName" formControlName="MiddleName"
                                                                        placeholder="Middle Name"
                                                                        [ngClass]="{ 'is-invalid': submitted && personalFormGroup.get('MiddleName').errors }"
                                                                        matInput [(ngModel)]="registerObj.MiddleName" type="text"
                                                                        #mname (keydown)="onEntermname($event)">
                                                                    <mat-error class="error"
                                                                        *ngIf="personalFormGroup.get('MiddleName').invalid && personalFormGroup.get('MiddleName').touched">
                                                                        Middle Name is required
                                                                        Enter
                                                                        only Alphabets</mat-error>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Last Name</mat-label>
                                                                    <input name="LastName" formControlName="LastName"
                                                                        placeholder="Last Name"
                                                                        [ngClass]="{ 'is-invalid': submitted && personalFormGroup.get('LastName').errors }"
                                                                        matInput required [(ngModel)]="registerObj.LastName"
                                                                        type="text" #lname (keydown)="onEnterlname($event)">
                                                                    <mat-error class="error"
                                                                        *ngIf="personalFormGroup.get('LastName').invalid && personalFormGroup.get('LastName').touched">Last
                                                                        Name is required Enter
                                                                        only
                                                                        Alphabets</mat-error>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Gender</mat-label>
                                                                    <mat-select formControlName="GenderId">
                                                                        <mat-option></mat-option>
                                                                        <mat-option *ngFor="let m of GenderList" [value]="m">
                                                                            {{m.GenderName}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                    <mat-error
                                                                        *ngIf="personalFormGroup.get('GenderId').invalid && personalFormGroup.get('GenderId').touched">
                                                                        <span
                                                                            *ngIf="personalFormGroup.get('GenderId').hasError('required')">
                                                                            Gender is required</span>
                                                                    </mat-error>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-button-toggle-group [(ngModel)]="dateStyle"
                                                                    (change)="OnChangeDobType($event)" aria-label="Font Style">
                                                                    <mat-button-toggle value="Date">Date</mat-button-toggle>
                                                                    <mat-button-toggle value="Day">Day</mat-button-toggle>
                                                                    <mat-button-toggle value="Month">Month</mat-button-toggle>
                                                                    <mat-button-toggle value="Year">Year</mat-button-toggle>
                                                                </mat-button-toggle-group>
                                                            </div>
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <div fxLayout="row" class="gap-8">
                                                                    <mat-form-field appearance="outline" *ngIf="dateStyle=='Year'">
                                                                        <mat-label>Age (Y)</mat-label>
                                                                        <input placeholder="Age (Y)" matInput
                                                                            (keyup)="CalcDOB('Year',$event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,3);">
                                                                    </mat-form-field>
                                                                    <mat-form-field appearance="outline" *ngIf="dateStyle=='Month'">
                                                                        <mat-label>Age (M)</mat-label>
                                                                        <input placeholder="Age (M)" matInput
                                                                            (keyup)="CalcDOB('Month',$event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,2);">
                                                                    </mat-form-field>
                                                                    <mat-form-field appearance="outline" *ngIf="dateStyle=='Day'">
                                                                        <mat-label>Age (D)</mat-label>
                                                                        <input placeholder="Age (D)" matInput
                                                                            (keyup)="CalcDOB('Day',$event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,2);">
                                                                    </mat-form-field>
                                                                    <mat-form-field appearance="outline">
                                                                        <input matInput [matDatepicker]="validFromPicker"
                                                                            formControllName="DateOfBirth" #bday
                                                                            [value]="registerObj.DateofBirth"
                                                                            (keydown)="onEnterbday($event)"
                                                                            [disabled]="dateStyle!='Date'"
                                                                            (dateChange)="onChangeDateofBirth($event.value)"
                                                                            placeholder="mm/dd/yyyy">
                                                                        <mat-datepicker-toggle matSuffix
                                                                            [for]="validFromPicker"></mat-datepicker-toggle>
                                                                        <mat-datepicker #validFromPicker></mat-datepicker>
                                                                    </mat-form-field>
                                                                </div>
                                                            </div>
                                                            <!-- age, month, dat -->
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <div fxLayout="row" class="gap-8">
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Age (Y)</mat-label>
                                                                        <input name="AgeYear" formControlName="AgeYear"
                                                                            placeholder="Age (Y)" matInput
                                                                            [(ngModel)]="registerObj.AgeYear"
                                                                            (ngModelChange)="registerObj.AgeYear = $event"
                                                                            maxlength="3" #agey readonly
                                                                            (keyup)="ageyearcheck(registerObj.AgeYear)"
                                                                            (keydown)="onEnteragey($event,registerObj.AgeYear)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,3);">
                                                                        <mat-error
                                                                            *ngIf="personalFormGroup.get('AgeYear').invalid && personalFormGroup.get('AgeYear').touched">Please
                                                                            enter Age Year </mat-error>
                                                                    </mat-form-field>
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Age (M)</mat-label>
                                                                        <input name="AgeMonth" formControlName="AgeMonth"
                                                                            placeholder="Age (M)" matInput readonly
                                                                            [(ngModel)]="registerObj.AgeMonth"
                                                                            (ngModelChange)="registerObj.AgeMonth = $event"
                                                                            type="number" maxlength="2" #agem
                                                                            (keydown)="onEnteragem($event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,2);">
                                                                        <mat-error
                                                                            *ngIf="personalFormGroup.get('AgeMonth').invalid && personalFormGroup.get('AgeMonth').touched">
                                                                            Please enter Age Month </mat-error>
                                                                    </mat-form-field>
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Age (D)</mat-label>
                                                                        <input name="AgeDay" formControlName="AgeDay"
                                                                            placeholder="Age (D)" matInput
                                                                            [(ngModel)]="registerObj.AgeDay" readonly
                                                                            (ngModelChange)="registerObj.AgeDay = $event"
                                                                            type="number" maxlength="2" #aged
                                                                            (keydown)="onEnteraged($event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,2);">
                                                                        <mat-error
                                                                            *ngIf="personalFormGroup.get('AgeDay').invalid && personalFormGroup.get('AgeDay').touched">
                                                                            Please enter Age Day </mat-error>
                                                                    </mat-form-field>
                                                                </div>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <!-- <mat-form-field appearance="outline">
                                                                    <mat-label>Pan Card No</mat-label>
                                                                    <input name="PanCardNo" formControlName="PanCardNo"
                                                                        placeholder="PanCardNo Number" matInput
                                                                        [(ngModel)]="registerObj.PanCardNo" #paPdfn
                                                                        (keydown)="onEnterpan($event)">
                                                                    <mat-error class="error"
                                                                        *ngIf="personalFormGroup.get('PanCardNo').invalid && personalFormGroup.get('PanCardNo').touched">12
                                                                        digits Pan Card No is required</mat-error>
                                                                </mat-form-field> -->
            
            
            
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>AadharCard Number</mat-label>
                                                                    <input name="AadharCardNo" formControlName="AadharCardNo"
                                                                        placeholder="AadharCard Number" matInput
                                                                        [(ngModel)]="registerObj.AadharCardNo" type="number"
                                                                        #AadharCardNo (keydown)="onEnterAadharCardNo($event)"
                                                                        type="number"
                                                                        oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0, 12);">
                                                                    <!-- <mat-error class="error"
                                                                        *ngIf="personalFormGroup.get('AadharCardNo').invalid && personalFormGroup.get('AadharCardNo').touched">Aadhar
                                                                        number is required
                                                                    </mat-error> -->
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Address</mat-label>
                                                                    <input name="Address" formControlName="Address"
                                                                        placeholder="Address" matInput #address
                                                                        (keydown)="onEnteraddress($event)"
                                                                        [(ngModel)]="registerObj.Address">
                                                                    <mat-error
                                                                        *ngIf="personalFormGroup.get('Address').invalid && personalFormGroup.get('Address').touched">Please
                                                                        enter Address </mat-error>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Area Name</mat-label>
                                                                    <input matAutocompletePosition="below" type="text"
                                                                        placeholder="Select Area" matInput formControlName="AreaId"
                                                                        [matAutocomplete]="autoArea" #area
                                                                        (keydown)="onEnterarea($event)">
                                                                    <span matSuffix style="display: flex;">
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('AreaId').setValue(''); isAreaSelected = false;">close</mat-icon>
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('AreaId').setValue(''); isAreaSelected = false;">search</mat-icon>
                                                                    </span>
                                                                    <mat-autocomplete #autoArea="matAutocomplete"
                                                                        [displayWith]="getOptionTextArea">
                                                                        <mat-option
                                                                            *ngFor="let option of filteredOptionsArea | async"
                                                                            [value]="option">
                                                                            {{option.AreaName}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>City</mat-label>
                                                                    <input matAutocompletePosition="below" type="text"
                                                                        placeholder="Select City" matInput #city
                                                                        (keydown)="onEntercity($event,vCityId.CityId)"
                                                                        formControlName="CityId" [matAutocomplete]="autoCity"
                                                                        required [(ngModel)]="vCityId">
                                                                    <span matSuffix style="display: flex;">
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('CityId').setValue(''); isCitySelected = false;">close</mat-icon>
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('CityId').setValue(''); isCitySelected = false;">search</mat-icon>
                                                                    </span>
                                                                    <mat-autocomplete #autoCity="matAutocomplete"
                                                                        [displayWith]="getOptionTextCity">
                                                                        <mat-option
                                                                            *ngFor="let option of filteredOptionsCity | async"
                                                                            [value]="option"
                                                                            (onSelectionChange)="onChangeCityList(option)">
                                                                            {{option.CityName}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>State Name</mat-label>
                                                                    <mat-select formControlName="StateId" name="StateId"
                                                                        (selectionChange)="onChangeCountryList($event.value)">
                                                                        <mat-option></mat-option>
                                                                        <mat-option *ngFor="let m of stateList" [value]="m">
                                                                            {{m.StateName}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Country Name</mat-label>
                                                                    <mat-select formControlName="CountryId">
                                                                        <mat-option></mat-option>
                                                                        <mat-option *ngFor="let g of countryList" [value]="g">
                                                                            {{g.CountryName}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Marital Status</mat-label>
                                                                    <input matAutocompletePosition="below" type="text"
                                                                        placeholder="Select Mstatus" matInput #mstatus
                                                                        (keydown)="onEntermstatus($event)"
                                                                        formControlName="MaritalStatusId"
                                                                        [matAutocomplete]="autoMstatus">
                                                                    <span matSuffix style="display: flex;">
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('MaritalStatusId').setValue(''); isMstatusSelected = false;">close</mat-icon>
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('MaritalStatusId').setValue(''); isMstatusSelected = false;">search</mat-icon>
                                                                    </span>
                                                                    <mat-autocomplete #autoMstatus="matAutocomplete"
                                                                        [displayWith]="getOptionTextMstatus">
                                                                        <mat-option
                                                                            *ngFor="let option of filteredOptionsMstatus | async"
                                                                            [value]="option">
                                                                            {{option.MaritalStatusName}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
                                                            <!-- Phone number -->
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <div fxLayout="row" class="gap-8">
                                                                    <!-- <mat-form-field appearance="outline">
                                                                        <mat-label>Mobile Number</mat-label>
                                                                        <input name="MobileNo" formControlName="MobileNo"
                                                                            placeholder="Mobile Number" matInput required
                                                                            [(ngModel)]="registerObj.MobileNo" minlength="10"
                                                                            maxlength="10" required="required" #mobile
                                                                            (keydown)="onEntermobile($event)"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0,10);"
                                                                            type="number" value="MobileNo.length">
                                                                        <mat-error class="error"
                                                                            *ngIf="personalFormGroup.get('MobileNo').invalid && personalFormGroup.get('MobileNo').touched">10
                                                                            digits Mobile number is
                                                                            required</mat-error>
                                                                    </mat-form-field> -->
            
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Mobile Number</mat-label>
                                                                        <input name="MobileNo" formControlName="MobileNo" #mobile
                                                                            placeholder="Mobile Number" matInput required
                                                                            [(ngModel)]="registerObj.MobileNo" max="9999999999"
                                                                            min="1000000000" autocomplete="off" maxlength="10"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0, 10);"
                                                                            required="required" value="9876658688"
                                                                            (keydown.enter)="onEntermobile($event)"
                                                                            (blur)="onEntermobile($event)">
                                                                        <mat-error class="error"
                                                                            *ngIf="personalFormGroup.get('MobileNo').invalid && personalFormGroup.get('MobileNo').touched">10
                                                                            digits Mobile number is
                                                                            required</mat-error>
                                                                    </mat-form-field>
            
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Phone Number</mat-label>
                                                                        <input name="PhoneNo" formControlName="PhoneNo" #phone
                                                                            placeholder="Phone Number" matInput
                                                                            [(ngModel)]="registerObj.PhoneNo" max="9999999999"
                                                                            min="1000000000" autocomplete="off" maxlength="10"
                                                                            oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0, 10);"
                                                                            value="9876658688"
                                                                            (keydown.enter)="onEnterphone($event)"
                                                                            (blur)="onEnterphone($event)">
                                                                        <!-- <mat-error class="error"
                                                                            *ngIf="personalFormGroup.get('MobileNo').invalid && personalFormGroup.get('MobileNo').touched">10
                                                                            digits Mobile number is
                                                                            required</mat-error> -->
                                                                    </mat-form-field>
            
            
                                                                    <!-- <mat-form-field appearance="outline">
                                                                        <mat-label>Phone Number</mat-label>
                                                                        <input name="PhoneNo" formControlName="PhoneNo"
                                                                            placeholder="Phone Number" matInput #phone
                                                                            (keydown)="onEnterphone($event)"
                                                                            [(ngModel)]="registerObj.PhoneNo" minlength="10"
                                                                            maxlength="10" type="number" value="9876658688">
                                                                    </mat-form-field> -->
                                                                </div>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
            
                                                                <mat-form-field appearance="outline">
                                                                    <mat-label>Religion Name</mat-label>
                                                                    <input matAutocompletePosition="below" type="text"
                                                                        placeholder="Select Religion" matInput #religion
                                                                        (keydown)="onEnterreligion($event)"
                                                                        formControlName="ReligionId"
                                                                        [matAutocomplete]="autoReligion">
                                                                    <span matSuffix style="display: flex;">
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('ReligionId').setValue(''); isreligionSelected = false;">close</mat-icon>
                                                                        <mat-icon class="mat-icon-close"
                                                                            (click)="personalFormGroup.get('ReligionId').setValue(''); isreligionSelected = false;">search</mat-icon>
                                                                    </span>
                                                                    <mat-autocomplete #autoReligion="matAutocomplete"
                                                                        [displayWith]="getOptionTextReligion">
                                                                        <mat-option
                                                                            *ngFor="let option of filteredOptionsReligion | async"
                                                                            [value]="option">
                                                                            {{option.ReligionName}}
                                                                        </mat-option>
                                                                    </mat-autocomplete>
                                                                </mat-form-field>
                                                            </div>
            
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <div fxLayout="row" class="gap-8">
                                                                    <mat-checkbox formControlName="IsHealthCard"
                                                                        (change)="chkHealthcard($event)"
                                                                        style="padding: 15px;">IsHealthCard
                                                                    </mat-checkbox>&nbsp;
                                                                </div>
                                                            </div>
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline" *ngIf="Healthcardflag">
                                                                    <mat-label>Follow Up Date</mat-label>
                                                                    <input matInput [matDatepicker]="pickerHealthcard"
                                                                        placeholder="Choose a date" formControlName="HealthcardDate"
                                                                        [(ngModel)]="HealthCardExpDate">
                                                                    <mat-datepicker-toggle matSuffix
                                                                        [for]="pickerHealthcard"></mat-datepicker-toggle>
                                                                    <mat-datepicker #pickerHealthcard></mat-datepicker>
                                                                </mat-form-field>
                                                            </div>
                                                            <div fxFlex="25%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                                <mat-form-field appearance="outline" *ngIf="Healthcardflag">
                                                                    <mat-label>Health Card No.</mat-label>
                                                                    <input type="text" placeholder="Enter Health Card No" matInput
                                                                        #healthcard [(ngModel)]="vhealthCardNo"
                                                                        formControlName="HealthCardNo"
                                                                        (keypress)="keyPressAlphanumeric($event)">
                                                                </mat-form-field>
                                                            </div>
                                                            <!-- </div> -->
                                                        </div>
                                                        <!-- Photo capture -->
                                                        <div fxFlex="15%" fxFlex.xs="100%" fxFlex.sm="20%">
                                                            <div class="photo-capture p-16 border border-radius-4 gap-12"
                                                                fxLayout="column">
                                                                <div class="photp-capture-image">
                                                                    <img class="h-100-p w-100-p border-radius-4"
                                                                        [src]="sanitizeImagePreview ? sanitizeImagePreview:'/assets/images/default.jpg'" />
                                                                </div>
                                                                <div class="photo-capture-button "> 
                                                                    <label
                                                                        class="btn btn-primary-outline btn-hover btn-with-icon w-100-p m-0 "
                                                                        (click)="openCamera('camera','photo')">
                                                                        <span class="btn-icon">
                                                                            <mat-icon>camera_enhance</mat-icon>
                                                                        </span> 
                                                                        <span>Capture image</span>
                                                                    </label>
            
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            </mat-expansion-panel>
            
                                            <mat-expansion-panel expanded class="mt-12">
                                                <mat-expansion-panel-header>
                                                    <mat-panel-title>
                                                        Visit Details
                                                    </mat-panel-title>
                                                </mat-expansion-panel-header>
                                                <form [formGroup]="VisitFormGroup" class="mat-form-field-100">
                                                    <div fxFlex="100" fxLayout="row wrap" fxLayoutGap="10px grid">
            
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
            
            
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Patient Type</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Patient Type" [(ngModel)]="vPatientTypeID"
                                                                    required matInput #ptype
                                                                    (keydown)="onEnterptype($event,vPatientTypeID.PatientTypeId)"
                                                                    formControlName="PatientTypeID"
                                                                    [matAutocomplete]="autoPatientTypeID">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('PatientTypeID').setValue(''); ispatienttypeSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('PatientTypeID').setValue(''); ispatienttypeSelected = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoPatientTypeID="matAutocomplete"
                                                                    [displayWith]="getOptionTextpatienttype">
                                                                    <mat-option
                                                                        *ngFor="let option of filteredOptionsPatientType | async"
                                                                        [value]="option"
                                                                        (onSelectionChange)="onChangePatient(option)">
                                                                        {{option.PatientType}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
            
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Tariff Name</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Tariff Type" matInput #tariff required
                                                                    (keydown)="onEnterptariff($event,vTariff.TariffId)"
                                                                    formControlName="TariffId" [matAutocomplete]="autoTariffId"
                                                                    [(ngModel)]="vTariff">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('TariffId').setValue(''); isTariffIdSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('TariffId').setValue(''); isTariffIdSelected = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoTariffId="matAutocomplete"
                                                                    [displayWith]="getOptionTextTariff">
                                                                    <mat-option *ngFor="let option of filteredOptionsTarrif | async"
                                                                        [value]="option">
                                                                        {{option.TariffName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%"
                                                            *ngIf="isCompanySelected">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Company Name </mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Company" matInput
                                                                    formControlName="CompanyId" [matAutocomplete]="autoCompany">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('CompanyId').setValue(''); isCompanySelected1 = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('CompanyId').setValue(''); isCompanySelected1 = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoCompany="matAutocomplete"
                                                                    [displayWith]="getOptionTextCompany">
                                                                    <mat-option
                                                                        *ngFor="let option of filteredOptionsCompany | async"
                                                                        [value]="option">
                                                                        {{option.CompanyName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%"
                                                            *ngIf="isCompanySelected">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Sub Company Name </mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select SubCompany" matInput
                                                                    formControlName="SubCompanyId"
                                                                    [matAutocomplete]="autoSubCompany">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('SubCompanyId').setValue(''); isSubCompanySelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('SubCompanyId').setValue(''); isSubCompanySelected = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoSubCompany="matAutocomplete"
                                                                    [displayWith]="getOptionTextSubCompany">
                                                                    <mat-option
                                                                        *ngFor="let option of filteredOptionsSubCompany | async"
                                                                        [value]="option">
                                                                        {{option.CompanyName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Department</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Department" matInput #dept
                                                                    [(ngModel)]="vDepartmentid"
                                                                    (keydown)="onEnterdept($event,vDepartmentid.DepartmentId)"
                                                                    formControlName="Departmentid" [matAutocomplete]="autoDep"
                                                                    required>
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('Departmentid').setValue(''); isDepartmentSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('Departmentid').setValue(''); isDepartmentSelected = false;">search</mat-icon>
                                                                </span>
            
                                                                <mat-autocomplete #autoDep="matAutocomplete"
                                                                    [displayWith]="getOptionTextDep">
                                                                    <mat-option *ngFor="let option of filteredOptionsDep | async"
                                                                        [value]="option"
                                                                        (onSelectionChange)="OnChangeDoctorList(option)">
                                                                        {{option.DepartmentName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Doctor Name</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Pick one" matInput #deptdoc
                                                                    (keydown)="onEnterdeptdoc($event,vDoctorId.DoctorId)"
                                                                    [(ngModel)]="vDoctorId" formControlName="DoctorID"
                                                                    [matAutocomplete]="autoDoctor" required>
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('DoctorID').setValue(''); isDoctorSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('DoctorID').setValue(''); isDoctorSelected = false;">search</mat-icon>
                                                                </span>
            
                                                                <mat-autocomplete #autoDoctor="matAutocomplete"
                                                                    [displayWith]="getOptionTextDoc">
                                                                    <mat-option *ngFor="let option of filteredOptionsDoc | async"
                                                                        [value]="option"
                                                                        (onSelectionChange)="isDoctorSelected = true;">
                                                                        {{option.Doctorname }} <b>|</b> {{option.DepartmentName }}
                                                                        <b>|</b> {{option.DoctorId
                                                                        }}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
            
            
            
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Ref Doctor Name</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Ref Doctor " matInput #refdoc
                                                                    (keydown)="onEnterrefdoc($event)" formControlName="RefDocId"
                                                                    [matAutocomplete]="autoRefdoc">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('RefDocId').setValue(''); isRefDoctorSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('RefDocId').setValue(''); isRefDoctorSelected = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoRefdoc="matAutocomplete"
                                                                    [displayWith]="getOptionTextRefDoc">
                                                                    <mat-option *ngFor="let option of filteredOptionsRefDoc | async"
                                                                        [value]="option">
                                                                        {{option.DoctorName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>
                                                        </div>
            
                                                        <div fxFlex="20%" fxFlex.xs="100%" fxFlex.sm="33%">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Purpose</mat-label>
                                                                <input matAutocompletePosition="below" type="text"
                                                                    placeholder="Select Purpose" matInput #purpose
                                                                    formControlName="PurposeId" [matAutocomplete]="autoPurpose">
                                                                <span matSuffix style="display: flex;">
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('PurposeId').setValue(''); isPurposeSelected = false;">close</mat-icon>
                                                                    <mat-icon class="mat-icon-close"
                                                                        (click)="VisitFormGroup.get('PurposeId').setValue(''); isPurposeSelected = false;">search</mat-icon>
                                                                </span>
                                                                <mat-autocomplete #autoPurpose="matAutocomplete"
                                                                    [displayWith]="getOptionTextPurpose">
                                                                    <mat-option
                                                                        *ngFor="let option of filteredOptionsPurpose | async"
                                                                        [value]="option">
                                                                        {{option.PurposeName}}
                                                                    </mat-option>
                                                                </mat-autocomplete>
                                                            </mat-form-field>  
                                                        </div> 
                                                    </div> 
                                                </form>
                                            </mat-expansion-panel>
                                        </mat-accordion>
            
                                        <div class="new-appointment-actions gap-8 mt-12" fxLayout="row" fxLayoutAlign="end center">
                                         
                                            <button class="btn btn-danger-outline" (click)="onClose()">Reset</button>
                                            <button class="btn btn-primary " color="accent" (click)="onNewSave()"
                                                [disabled]="personalFormGroup.invalid || VisitFormGroup.invalid">
                                                <span>Save</span>
                                            </button>
                                        </div>
            
            
                                    </div>
                                </div>
                            </div>
                        </div> 
              
            </div>
        </div>
    </div>
</div>

