<div fxFlexFill fxLayout="row" fxLayout.gt-xs="column" fxLayoutGap="10px" style="width: 100%; background:#F5F5F5;  " >
    <!--padding: 10px 10px 10px 10px;-->
    <!-- <div class="col-md-12" style="padding:10px;" *ngIf="selectedView == 'Dropdown'"> -->
    <div class="container" style="width: 100%;">
        <div style="width: 100%;">
            <!-- <div fxFlex> -->
            <div fxLayout="row" fxLayoutAlign="start center" class="accent">
                <div class="logo opd-dialog-header px-8 " fxLayout="row" fxLayoutAlign="start center"
                    style="width: 100%;">
                    <button mat-icon-button class="sidebar-toggle mr-12">
                        <mat-icon>menu</mat-icon>
                    </button>

                    <span class="logo-text h2" [@animate]="{value:'*',params:{delay:'100ms',x:'-16px'}}"
                        style="width: 98%;font-size: 16px;">
                        OPD BILLING
                    </span>

                    <div fxLayout="row" style="float: right; margin-right: 5px;">
                        <!-- <span style="margin-right: 40px;color: aliceblue;font-weight: bold;">
                            <app-common-date [screenFrom]="screenFromString"
                                (dateTimeEventEmitter)="getDateTime($event)"></app-common-date>
                        </span> -->
                        <!-- <span class="material-icons" style="cursor: pointer;" (click)="onClose()">
                            close
                        </span> -->
                    </div>
                </div>
            </div>


            <mat-card-content style="width: 100%;" class="m-0">
                <div fxLayout="column">
                    <div class="patient-name-header">
                        <mat-card class="px-12 py-8">
                            <form [formGroup]="searchFormGroup">
                                <div fxLayout="row" fxLayoutAlign="space-between" fxLayoutGap="5px">

                                    <mat-form-field class=searchRegId appearance="outline"
                                        style="width:600px !important;margin-left:20px;">
                                        <input type="text" name="RegId" formControlName="RegId"
                                            placeholder="Patient Name (enter 2 char)/ MR No/ Mobile No " matInput
                                            [matAutocomplete]="auto1" (input)="getSearchList()" maxlength="10">
                                        <span matSuffix style="display: flex;">
                                            <mat-icon class="mat-icon-close"
                                                (click)="searchFormGroup.get('RegId').setValue(''); isRegIdSelected = false;">close</mat-icon>
                                            <mat-icon class="mat-icon-close"
                                                (click)="searchFormGroup.get('RegId').setValue(''); isRegIdSelected = false;">search</mat-icon>
                                        </span>
                                        <mat-autocomplete #auto1="matAutocomplete" [displayWith]="getOptionText1"
                                            (optionSelected)='getSelectedObj1($event.option.value)'>
                                            <mat-option *ngFor="let option of PatientListfilteredOptions"
                                                [value]="option">
                                                {{option.RegNo}} |{{option.FirstName}} {{option.MiddleName}}
                                                {{option.LastName}} |
                                                {{option.MobileNo}} | {{option.DoctorName}} | {{option.OPDNo}}
                                            </mat-option>
                                        </mat-autocomplete>
                                        <!-- <mat-error *ngIf="searchFormGroup.get('ItemId').hasError('required')">
                                  Required field cannot be left blank
                                </mat-error> -->
                                    </mat-form-field>

                                    <span style="margin-right: 40px;">
                                        <app-common-date [screenFrom]="screenFromString"
                                            (dateTimeEventEmitter)="getDateTime($event)"></app-common-date>
                                    </span>
                                </div>
                                <!-- <div>
                                    <span
                                        style="margin-left: 30px;font-size: medium;color: rgb(3, 83, 83);font-weight: bold;">Patient
                                        Name :{{PatientName}}
                                        <span style="margin-left: 10px;">OPDNo :{{vOPDNo}}</span>
                                             <span style="margin-left: 10px;">Company Name :{{CompanyName}}</span>
                                            <span style="margin-left: 10px;">Tarrif :{{Tarrifname}}</span>
                                            <span style="margin-left: 10px;">Doctor Name :{{Doctorname}}</span>
    
                                        </span>
                                </div> -->
                            </form>
                        </mat-card>
                    </div>
                    <div class="patient-info">
                        <mat-card class="px-12 py-8">
                            <fieldset class="fieldset-div">
                                <legend>Patient Information</legend>
                                <div fxFlexFill fxLayout="row" fxLayoutAlign="space-between center"
                                    class="patient-info">
                                    <div class="patient-sub">
                                        <div class="patient-info-1-111" fxLayout="row"
                                            fxLayoutAlign="space-between center">
                                            <div class="flex-item">
                                                <h3 class="labels-h3">Patient Name</h3>
                                            </div>
                                            <div class="flex-item-middle">
                                                <h6 class="labels-h6">:</h6>
                                            </div>
                                            <div class="flex-item" style="width: 275px;">
                                                <h6 class="labels-h6">{{PatientName}}</h6>
                                            </div>
                                            <div class="flex-item item-header" style="margin-left: 10px;">
                                                <h3 class="labels-h3">OPIPNo</h3>
                                            </div>
                                            <div class="flex-item-middle">
                                                <h6 class="labels-h6">:</h6>
                                            </div>
                                            <div class="flex-item">
                                                <h6 class="labels-h6">{{vOPDNo}}</h6>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="patient-sub">
                                        <div class="patient-info-1-111" fxLayout="row"
                                            fxLayoutAlign="space-between center">
                                            <div class="flex-item item-header">
                                                <h3 class="labels-h3">DoctorName</h3>
                                            </div>
                                            <div class="flex-item-middle">
                                                <h6 class="labels-h6">:</h6>
                                            </div>
                                            <div class="flex-item">
                                                <h6 class="labels-h6">{{Doctorname}}</h6>
                                            </div>
                                            <div class="flex-item item-header">
                                                <h3 class="labels-h3">CompanyName</h3>
                                            </div>
                                            <div class="flex-item-middle">
                                                <h6 class="labels-h6">:</h6>
                                            </div>
                                            <div class="flex-item">
                                                <h6 class="labels-h6">{{CompanyName}}</h6>
                                            </div>

                                            <div class="flex-item item-header">
                                                <h3 class="labels-h3">TarrifName</h3>
                                            </div>
                                            <div class="flex-item-middle">
                                                <h6 class="labels-h6">:</h6>
                                            </div>
                                            <div class="flex-item">
                                                <h6 class="labels-h6">{{Tarrifname}}</h6>
                                            </div>
                                        </div>
                                        <div class="patient-info-1-2" fxLayout="row"
                                            fxLayoutAlign="space-between center">
                                            <!-- <div class="flex-item item-header">
                                            <h3 class="labels-h3">DoctorName</h3>
                                        </div>
                                        <div class="flex-item-middle">
                                            <h6 class="labels-h6">:</h6>
                                        </div>
                                        <div class="flex-item">
                                            <h6 class="labels-h6">{{Doctorname}}</h6>
                                        </div> -->


                                            <!-- <div class="flex-item item-header">
                                            <h3 class="labels-h3">Doctor</h3>
                                        </div>
                                        <div class="flex-item-middle">
                                            <h6 class="labels-h6">:</h6>
                                        </div>
                                        <div class="flex-item">
                                            <h6 class="labels-h6">XYZ XYZ Xyz</h6>
                                        </div> -->
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </mat-card>
                    </div>
                </div>
                <div fxLayout="column">
                    <div class="content-card patient-form" style="width:100%;  background-color: white;">
                        <div fxLayout="column" fxLayout.gt-xs="column" fxLayoutGap="3px">
                            <!-- ================================ LABEL HEADER  -->
                            <mat-card fxFlex.gt-sm="100%" fxFlex>
                                <form [formGroup]="registeredForm" style="display: flex;" #f="ngForm" #aForm>

                                    <div fxLayout="row" fxLayoutAlign="space-between" fxLayoutGap="5px">
                                        <mat-form-field appearance="outline" style="width:400px;" #myInput>
                                            <input type="text" name="SrvcName" formControlName="SrvcName" #itemid
                                                placeholder="Service Name" matInput [matAutocomplete]="auto"
                                                (keydown)="onEnterservice($event)" (input)="getServiceListCombobox()"
                                                required id="myInput">

                                            <mat-autocomplete #auto="matAutocomplete" [displayWith]="getOptionText"
                                                showPanel="true" (optionsScroll)="onScroll()"
                                                (optionSelected)='getSelectedObj($event.option.value)'
                                                style="width: 500px;">
                                                <mat-option *ngFor="let option of filteredOptions" [value]="option"
                                                    style="width: 500px;">
                                                    {{option.ServiceName}} | Price {{option.Price}}
                                                </mat-option>
                                            </mat-autocomplete>
                                            <mat-hint>
                                                <span *ngIf="noOptionFound" style="color: #f44336;">No data
                                                    Found</span>
                                            </mat-hint>
                                            <mat-error *ngIf="registeredForm.get('SrvcName').hasError('required')">
                                                Required field cannot be left blank
                                            </mat-error>
                                        </mat-form-field>


                                        <mat-form-field appearance="outline" #Price style="width:100px;">
                                            <mat-label>Price</mat-label>
                                            <input matInput [(ngModel)]="b_price" name="bPrice" #price
                                                (keyup)="calculateTotalAmtbyprice()" formControlName="price" required
                                                type="number" id="Price" (keydown)="onEnterorice($event)"
                                                oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1').slice(0, 10);">
                                            <mat-error
                                                *ngIf="registeredForm.get('price').invalid && registeredForm.get('price').touched">
                                                Price is required</mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" style="width:100px;">
                                            <mat-label>Qty</mat-label>
                                            <input matInput [(ngModel)]="b_qty" name="bQty" #qty
                                                (keyup)="calculateTotalAmt()" formControlName="qty" required
                                                (keydown)="onEnterqty($event)">
                                            <mat-error
                                                *ngIf="registeredForm.get('qty').invalid && registeredForm.get('qty').touched">
                                                Qty is required</mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" style="width:100px;">
                                            <mat-label>TotalAmt</mat-label>
                                            <input matInput [(ngModel)]="b_totalAmount" name="bTotalAmt" readonly
                                                formControlName="ChargeTotalAmount" required>
                                            <mat-error
                                                *ngIf="registeredForm.get('ChargeTotalAmount').invalid && registeredForm.get('ChargeTotalAmount').touched">
                                                TotalAmount is required</mat-error>
                                        </mat-form-field>

                                        <div style="margin-right: 10px; width:200px;" *ngIf="isDoctor">
                                            <mat-form-field appearance="outline" fxFlex id="DoctorID">
                                                <mat-label>Doctor Name</mat-label>
                                                <mat-select formControlName="DoctorID" placeholder="Doctor" #Doctor
                                                    #singleSelect (keydown)="onEnterdoctor($event)">
                                                    <mat-option>
                                                        <ngx-mat-select-search [formControl]="doctorFilterCtrl"
                                                            [placeholderLabel]="'Search'"
                                                            [noEntriesFoundLabel]="'No matching found'">
                                                        </ngx-mat-select-search>
                                                    </mat-option>
                                                    <mat-option *ngFor="let element of filteredDoctor | async"
                                                        [value]="element">
                                                        {{element.DoctorName}}
                                                    </mat-option>
                                                    <mat-hint>Plz Select Doctor Name</mat-hint>
                                                    <mat-error
                                                        *ngIf="registeredForm.get('DoctorID').hasError('required')">
                                                        Required field cannot be left blank
                                                    </mat-error>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>

                                        <mat-form-field appearance="outline" style="width:100px;">
                                            <mat-label>Disc %</mat-label>
                                            <input matInput [(ngModel)]="v_ChargeDiscPer" name="v_ChargeDiscPer" #disper
                                                (keyup)="calculatePersc()" formControlName="ChargeDiscPer" type="number"
                                                (keydown)="onEnterdiscper($event)">
                                            <mat-error
                                                *ngIf="registeredForm.get('ChargeDiscPer').invalid && registeredForm.get('ChargeDiscPer').touched">
                                                Percentage is Number</mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" style="width:100px;">
                                            <mat-label>Disc Amt</mat-label>
                                            <input matInput [(ngModel)]="b_ChargeDisAmount" name="b_ChargeDisAmount"
                                                #discamt formControlName="ChargeDiscAmount" type="number"
                                                (keyup)="calculatechargesDiscamt()"
                                                (keydown)="onEnterdiscAmount($event)" id="DiscAmt">
                                            <mat-error
                                                *ngIf="registeredForm.get('ChargeDiscAmount').invalid && registeredForm.get('ChargeDiscAmount').touched">
                                                Discount Amount Schod me Less than Tptal Amount TotalAmount is
                                                required</mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" style="width:100px;">
                                            <mat-label>NetAmount</mat-label>
                                            <input matInput [(ngModel)]="b_netAmount" name="b_netAmount" readonly
                                                formControlName="netAmount" required (keyup)="addData()" #netamt>
                                            <mat-error
                                                *ngIf="registeredForm.get('netAmount').invalid && registeredForm.get('netAmount').touched">
                                                NetAmount is required</mat-error>
                                        </mat-form-field>

                                        <div matTooltip="Enter all data to enable this button!!"
                                            [matTooltipDisabled]="!registeredForm.invalid"
                                            [matTooltipPosition]="'above'">
                                            <button fxLayoutAlign="center center" #addbutton
                                                class="btn btn-primary btn-with-icon" [disabled]="!add"
                                                (click)="onAddCharges()">
                                                <span class="btn-icon">
                                                    <mat-icon> add </mat-icon>
                                                </span>
                                                <span>Add</span>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </mat-card>
                        </div>
                    </div>
                    <div class="billing-table">
                        <div fxLayout="row" fxFlex="100" fxLayout.gt-xs="column">
                            <mat-tab-group>
                                <mat-tab>
                                    <ng-template mat-tab-label>
                                        <!-- <mat-icon class="example-tab-icon">thumb_up</mat-icon>&nbsp; -->
                                        chargeslist
                                    </ng-template>
                                    <div>
                                        <div class="col-md-12">
                                            <!-- ================= Charges List Table ======================= -->
                                            <mat-table #table matSort [dataSource]="dataSource"
                                                [@animateStagger]="{value:'50'}"
                                                style="height:200px !important;overflow: auto;">
                                                <!-- <ng-container matColumnDef="checkbox" sticky>
                                    style="overflow:auto; border: 1px solid;" class="mat-data-table">
                                    <ng-container matColumnDef="checkbox" sticky>
                                        <mat-header-cell *matHeaderCellDef mat-sort-header>
                                            <span class="material-icons" (click)="getChargesList()">
                                                cached
                                            </span>
                                        </mat-header-cell>
                                        <mat-cell *matCellDef="let contact">
                                            <mat-checkbox aria-label="Checked">
                                             
                                            </mat-checkbox>
                                        </mat-cell>
                                    </ng-container> -->
                                                <!-- <ng-container matColumnDef="checkbox">
                                                        <mat-header-cell *matHeaderCellDef mat-sort-header>
    
                                                        </mat-header-cell>
                                                        <mat-cell *matCellDef="let contact">
                                                            <mat-checkbox aria-label="Checked"
                                                                (change)="tableElementChecked($event, contact)">
                                                            </mat-checkbox>
                                                        </mat-cell>
                                                    </ng-container> -->
                                                <ng-container matColumnDef="ChargesDate">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header class="w-120"
                                                        style="margin-right: 5px;">Date</mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" class="w-120">
                                                        {{contact.ChargesDate}}
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="action">
                                                    <mat-header-cell *matHeaderCellDef style="color: white;"> Action
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let row">
                                                        <!-- <button mat-icon-button (click)="onEdit(row)">
                                                                <mat-icon title="Edit Menu">launch</mat-icon>
                                                            </button> -->
                                                        <button mat-icon-button (click)="deleteTableRow(row)"
                                                            color="warn">
                                                            <mat-icon>delete_outline</mat-icon>
                                                        </button>
                                                        <!-- <button mat-icon-button (click)="onDeactive(row.RegId)" color="warn"><mat-icon>delete_outline</mat-icon></button>       -->
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="ServiceName">
                                                    <mat-header-cell class="w-250" *matHeaderCellDef mat-sort-header
                                                        fxShow.gt-sm> Service Name
                                                    </mat-header-cell>
                                                    <mat-cell class="w-250" *matCellDef="let contact" fxShow.gt-sm>
                                                        {{contact.ServiceName}}
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="Price">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-90">
                                                        Price
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-90">
                                                        {{contact.Price | currency:'INR' }}
                                                        <!-- <mat-form-field appearance="legacy">
                                                <input matInput [(ngModel)]="contact.Price" (keyup)="getTotalAmount(contact)">
                                                <span matPrefix>₹</span>
                                            </mat-form-field> -->
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="Qty">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-60">Qty
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-60">
                                                        {{contact.Qty}}
                                                        <!-- <mat-form-field appearance="legacy">
                                                <input matInput [(ngModel)]="contact.Qty" (keyup)="getTotalAmount(contact)">
                                            </mat-form-field> -->
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="TotalAmt">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-120">
                                                        Total Amt
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-120">
                                                        {{contact.TotalAmt | currency:'INR' }}
                                                    </mat-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="DiscPer">
                                                    <mat-header-cell class="w-100" *matHeaderCellDef mat-sort-header
                                                        class="w-70" fxShow.gt-sm>Disc %
                                                    </mat-header-cell>
                                                    <mat-cell class="w-100" *matCellDef="let contact" fxShow.gt-sm
                                                        class="w-70">
                                                        {{contact.ConcessionPercentage}}
                                                        <!-- <mat-form-field appearance="legacy">
                                                <input matInput [(ngModel)]="contact.ConcessionPercentage" (keyup)="getDiscAmount(contact)">
                                            </mat-form-field> -->
                                                    </mat-cell>
                                                </ng-container>
                                                <ng-container matColumnDef="DiscAmt">
                                                    <mat-header-cell class="w-100" *matHeaderCellDef mat-sort-header
                                                        fxShow.gt-sm class="w-90">Disc
                                                        Amt
                                                    </mat-header-cell>
                                                    <mat-cell class="w-100" *matCellDef="let contact" fxShow.gt-sm
                                                        class="w-90">
                                                        <!-- <mat-form-field appearance="legacy">
                                                <input matInput [(ngModel)]="contact.DiscAmt" (keyup)="getDiscValue(contact)">
                                                <span matPrefix>₹</span>
                                            </mat-form-field> -->
                                                        {{contact.DiscAmt | currency:'INR' }}
                                                    </mat-cell>
                                                </ng-container>
                                                <ng-container matColumnDef="NetAmount" class="w-110">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>
                                                        NetAmount
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-110">
                                                        {{contact.NetAmount | currency:'INR' }}
                                                    </mat-cell>
                                                </ng-container>

                                                <!-- <ng-container matColumnDef="DoctorId">
                                                        <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>
                                                           Charge DoctorId
                                                        </mat-header-cell>
                                                        <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                                                            {{contact.DoctorId}}
                                                        </mat-cell>
                                                    </ng-container> -->

                                                <ng-container matColumnDef="ChargeDoctorName">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-250">
                                                        ChargeDoctorName
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-250">
                                                        {{contact.DoctorName}}
                                                    </mat-cell>

                                                </ng-container>
                                                <ng-container matColumnDef="ClassName">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-150">
                                                        ClassName
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-150">
                                                        {{contact.ClassName}}
                                                    </mat-cell>
                                                </ng-container>
                                                <ng-container matColumnDef="ChargesAddedName">
                                                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm
                                                        class="w-100">
                                                        AddedBy
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-100">
                                                        {{contact.ChargesAddedName}}
                                                    </mat-cell>
                                                </ng-container>
                                                <ng-container matColumnDef="action" stickyEnd>
                                                    <mat-header-cell *matHeaderCellDef style="color: white;"
                                                        class="w-100">
                                                        Action
                                                    </mat-header-cell>
                                                    <mat-cell *matCellDef="let row" class="w-100">
                                                        <!-- <button mat-icon-button (click)="onEdit(row)">
                                                                <mat-icon title="Edit Menu">launch</mat-icon>
                                                            </button> -->
                                                        <button mat-icon-button (click)="deleteTableRow(row)"
                                                            color="warn">
                                                            <mat-icon>delete_outline</mat-icon>
                                                        </button>
                                                        <!-- <button mat-icon-button (click)="onDeactive(row.RegId)" color="warn"><mat-icon>delete_outline</mat-icon></button>       -->
                                                    </mat-cell>
                                                </ng-container>
                                                <!-- <div fxFlex="row" fxLayoutAlign="center center">
                                                <button mat-icon-button [matMenuTriggerFor]="moreMenu" aria-label="More"
                                                    (click)="$event.stopPropagation();">
                                                    <mat-icon class="secondary-text">more_vert</mat-icon>
                                                </button>
                                                <mat-menu #moreMenu="matMenu">
                                                    <ng-container *ngFor="let m of menuActions, let n of menuActions">
                                                        <button mat-menu-item aria-label="remove"
                                                            (click)="getRecord(contact,m)">
                                                            <span>{{m}}</span>
                                                        </button>
                                                    </ng-container>
                                                </mat-menu>
                                            </div> -->
                                                <ng-container matColumnDef="loading">
                                                    <mat-footer-cell *matFooterCellDef colspan="6">
                                                        loading data...
                                                    </mat-footer-cell>
                                                </ng-container>

                                                <ng-container matColumnDef="noData">
                                                    <mat-footer-cell *matFooterCellDef colspan="6">
                                                        <!-- <mat-spinner  class="spinner" [diameter]="35"
                                                [color]="blue"></mat-spinner> -->
                                                        <span>No Data Found</span>
                                                    </mat-footer-cell>
                                                </ng-container>

                                                <mat-header-row class="accent"
                                                    *matHeaderRowDef="displayedColumns; sticky: true">
                                                </mat-header-row>
                                                <mat-row *matRowDef="let contact; columns: displayedColumns;"
                                                    [ngClass]="{'row-yellow': contact.ServiceName == 'CBC'}"
                                                    [@animate]="{value:'*',params:{y:'100%'}}"></mat-row>
                                                <mat-footer-row *matFooterRowDef="['loading']"
                                                    [ngClass]="{'hide':dataSource!=null}">
                                                </mat-footer-row>
                                                <mat-footer-row *matFooterRowDef="['noData']"
                                                    [ngClass]="{'hide':!(dataSource!=null && dataSource.data.length==0)}">
                                                </mat-footer-row>
                                            </mat-table>
                                            <!-- ================= Charges List Footer Table ======================= -->
                                            <div class="service-amt-box py-4">
                                                <!-- <div class="paginator-div">
                                                        <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10"
                                                            showFirstLastButtons>
                                                        </mat-paginator>
                                                        <span class="net-amt-label">Total:</span>&nbsp;<span
                                                            class="net-amt-value">{{chargeslist.length}}</span>
                                                    </div> -->
                                                <div class="amount-box w-100-p gap-28" fxLayout="row"
                                                    fxLayoutAlign="center center">
                                                    <div class="no-of-service" fxLayout="row" fxLayoutGap="10px">
                                                        <span class="net-amt-label font-weight-600">No of Services :
                                                        </span>
                                                        <span
                                                            class="net-amt-value text-primary">{{dataSource.data.length}}</span>
                                                    </div>
                                                    <div class="net-amount" fxLayout="row" fxLayoutGap="10px">
                                                        <span class="net-amt-label font-weight-600"
                                                            style="margin-left: 500px;">Net Amount :
                                                        </span>
                                                        <span
                                                            class="net-amt-value text-primary">{{getNetAmtSum(dataSource.data)}}
                                                        </span>
                                                    </div>
                                                    <!-- Disc Amount
                                                        {{getDiscAmtSum(dataSource.data)}} -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </mat-tab>
                            </mat-tab-group>
                        </div>
                    </div>
                    <div class="billing-form-section">
                        <form [formGroup]="BillingForm">
                            <!-- style=" width:20%; float: right;  border-radius:4px; background-color: white; border:rgba(0,0,0,0.12) 1px solid; float: right;  padding: 1em; margin-top: 10px;" -->
                            <div fxFlex="100" class="content py-16 pl-10 p-12" fxLayout="row" fxLayout.gt-xs="column"
                                fusePerfectScrollbar
                                style="border-radius:4px; background-color: white; border:rgba(0,0,0,0.12) 1px solid;">
                                <div class="nav material2">
                                    <div class="billing-form-row gap-12" fxLayout="row" fxLayoutAlign="start none">
                                        <mat-form-field appearance="outline" class="Consession-field">
                                            <mat-label>Total Amount</mat-label>
                                            <input matInput [(ngModel)]="b_TotalChargesAmount"
                                                name="b_TotalChargesAmount" formControlName="TotallistAmount" readonly>
                                            <mat-error
                                                *ngIf="BillingForm.get('TotallistAmount').invalid && BillingForm.get('TotallistAmount').touched">
                                                FinalAmt is required</mat-error>
                                        </mat-form-field>

                                        <mat-form-field class="Consession-field" appearance="outline">
                                            <mat-label>Disc(%)</mat-label>
                                            <input matInput [(ngModel)]="b_concessionDiscPer"
                                                formControlName="concesDiscPer" name="b_concessionDiscPer"
                                                (keyup)="calcDiscPersonTotal()" placeholder="0" type="number">
                                            <mat-error
                                                *ngIf="BillingForm.get('concesDiscPer').invalid && BillingForm.get('concesDiscPer').touched">
                                                Percentage is Number</mat-error>
                                        </mat-form-field>

                                        <mat-form-field class="Consession-field" appearance="outline" fxFlex>
                                            <mat-label>Disc Amt</mat-label>
                                            <input matInput [(ngModel)]="b_concessionamt" name="b_Consessionamt"
                                                formControlName="concessionAmt" placeholder="0" type="number"
                                                (keyup)="calculateDiscamtfinal()">
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class="Consession-field" fxFlex>
                                            <mat-label>Net Amount</mat-label>
                                            <input matInput [(ngModel)]="TotalnetPaybleAmt" name="TotalnetPaybleAmt"
                                                formControlName="FinalAmt" readonly required>
                                            <mat-error
                                                *ngIf="BillingForm.get('FinalAmt').invalid && BillingForm.get('FinalAmt').touched">
                                                FinalAmt is required</mat-error>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" fxFlex *ngIf="Consessionres">
                                            <mat-label>Concession Reason Type</mat-label>
                                            <mat-select formControlName="ConcessionId" [disabled]="Consession">
                                                <mat-option *ngFor="let Doc of ConcessionReasonList" [value]="Doc">
                                                    {{Doc.ConcessionReason}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" fxFlex>
                                            <mat-label>Remark</mat-label>
                                            <input name="Address" appearance="legacy" style="color: green;"
                                                formControlName="BillRemark" placeholder="Remark" matInput>
                                        </mat-form-field>

                                        <!-- <mat-form-field appearance="outline" style="width: 250px;">
                                                <mat-label>Cash Counter</mat-label>
                                                <mat-select formControlName="CashCounterId">
                                                    <mat-option *ngFor="let m of CashCounterList" [value]="m">
                                                        {{m.CashCounterName}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field> -->
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign="space-between center">
                                        <mat-checkbox aria-label="Cash Payment" formControlName="cashpay" (checked)=true
                                            class="font-weight-600">
                                            Cash Payment
                                        </mat-checkbox>
                                        <div class="action-btns gap-8" fxLayout="row">
                                            <button class="btn btn-danger-outline btn-xs"
                                                (click)="onClose()">Reset</button>
                                            <button class="btn btn-primary-outline btn-xs" (click)="onSaveOPBill2()"
                                                [disabled]="BillingForm.invalid">Save</button>
                                        </div>
                                        <!-- <button class="next-btn" (click)="showNewPaymnet()"
                                        style="border-radius: 16px;">Save</button> -->
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </mat-card-content>
            <!-- Final bill calculation -->
        </div>
    </div>
</div>