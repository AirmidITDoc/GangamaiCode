<div class="parent-container" class="page-layout simple left-sidebar inner-sidebar inner-scroll" fusePerfectScrollbar style="overflow: auto;">
    <fieldset style="font-size: 17px;">
        <form [formGroup]="patientDetailsFormGrp">
        <legend>Bill Information</legend>
        <app-common-date [screenFrom]="screenFromString" (dateTimeEventEmitter)="getDateTime($event)"
        style="border-color: red;"></app-common-date>
        <div>
            <fieldset class="fieldset-div">
                <legend>Patient Information</legend>
                <div fxFlexFill fxLayout="row" fxLayoutAlign="space-between center" class="patient-info">
                    <div class="patient-sub">
                        <div class="patient-info-1-111" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item" style="width: 375px;">
                                <h3 class="labels-h3">Patient Name</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">{{PatientHeaderObj.PatientName}}</h6>
                            </div>
                        </div>
                        <div class="patient-info-1-2" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item" style="width: 375px;">
                                <h3 class="labels-h3">Patient Category</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">Staff</h6>
                            </div>
                        </div>
                    </div>

                    <div class="patient-sub">
                        <div class="patient-info-1-111" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Gender</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">Male</h6>
                            </div>
                        </div>
                        <div class="patient-info-1-2" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Tariff</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">Hospital</h6>
                            </div>
                        </div>
                    </div>

                    <div class="patient-sub">
                        <div class="patient-info-1-111" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Age</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">30</h6>
                            </div>
                        </div>
                        <div class="patient-info-1-2" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Company</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">Airmid</h6>
                            </div>
                        </div>
                    </div>

                    <div class="patient-sub">
                        <div class="patient-info-1-111" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Patient Source</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">Hospital</h6>
                            </div>
                        </div>
                        <div class="patient-info-1-2" fxLayout="row" fxLayoutAlign="space-between center">
                            <div class="flex-item item-header">
                                <h3 class="labels-h3">Doctor</h3>
                            </div>
                            <div class="flex-item-middle">
                                <h6 class="labels-h6">:</h6>
                            </div>
                            <div class="flex-item">
                                <h6 class="labels-h6">XYZ XYZ Xyz</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>
        <div>
            <fieldset class="fieldset-div">
                <legend>Patient Bill Information</legend>
                <div fxFlexFill fxLayout="row" fxLayoutAlign="space-between center" class="patient-info">
                    <div class="patient-bill-info" fxLayout="row wrap" fxLayoutGap="20px grid" fxLayoutAlign="space-between center">
                        <div class="bill-header" fxFlex="200px">
                            <h3 class="labels-h3">Advance Available</h3>
                        </div>
                        <div>
                            <h6 class="labels-h6">:</h6>
                        </div>
                        <div fxFlex="200px">
                            <h6 class="labels-h6">0</h6>
                        </div>
                    </div>

                    <div class="patient-bill-info" fxLayout="row wrap" fxLayoutGap="20px grid" fxLayoutAlign="space-between center">
                        <div fxFlex="200px">
                            <mat-checkbox><h3 class="labels-h3">Consume Advance</h3></mat-checkbox>
                        </div>
                    </div>

                    <div class="patient-bill-info" fxLayout="row wrap" fxLayoutGap="20px grid" fxLayoutAlign="space-between center">
                        <div fxFlex="150px">
                            <h3 class="labels-h3">Bill Amount</h3>
                        </div>
                        <div>
                            <h6 class="labels-h6">:</h6>
                        </div>
                        <div fxFlex="200px">
                            <i class="fas fa-indian-rupee-sign" style="margin-right: 5px;"></i>
                            <h6 class="labels-h6">{{netPayAmt}}</h6>
                        </div>
                    </div>

                    <div class="patient-bill-info" fxLayout="row wrap" fxLayoutGap="20px grid" fxLayoutAlign="space-between center">
                        <div fxFlex="200px">
                            <h3 class="labels-h3">Net Pay Amount</h3>
                        </div>
                        <div>
                            <h6 class="labels-h6">:</h6>
                        </div>
                        <div fxFlex="200px">
                            <i class="fas fa-indian-rupee-sign" style="margin-right: 5px;"></i>
                            <h6 class="labels-h6">{{netPayAmt}}</h6>
                        </div>
                    </div>
                </div>
            </fieldset>
        </div>

        <div>
            <fieldset>
                <legend>Payment Details</legend>
                         <!-- First Row 1 -->
                        <div fxFlexFill fxLayout="column" class="patient-details" fxLayoutGap="15px">

                        <div fxLayout="row wrap" fxLayoutGap="20px grid" class="field-row payment-container" *ngIf="paymentRowObj.cash">
                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Payment Type</mat-label>
                                <mat-select formControlName="paymentType1" [(ngModel)]="selectedPaymnet1"
                                    (selectionChange)="onPaymentChange(1, $event.value)" required>
                                    <mat-option *ngFor="let ele of paymentArr1" [value]="ele.value">
                                        {{ele.viewValue}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Amount</mat-label>
                                <input matInput formControlName="amount1" (keyup)="getBalanceAmt()" [(ngModel)]="amount1" required>
                            </mat-form-field>
                            <ng-container *ngIf="selectedPaymnet1 != 'cash'">
                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Reference Number</mat-label>
                                    <input matInput formControlName="referenceNumber1">
                                </mat-form-field>

                                <!-- <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Bank Name</mat-label>
                                    <input matInput formControlName="bankName1">
                                </mat-form-field> -->

                                <mat-form-field appearance="outline" fxFlex>
                                    <mat-label>Bank Name</mat-label>
                                    <input matAutocompletePosition="below" type="text" placeholder="Select Prefix" matInput
                                      formControlName="bankName1" [matAutocomplete]="autoBank1" required>
                                    <span matSuffix style="display: flex;">
                                      <mat-icon class="mat-icon-close"
                                        (click)="patientDetailsFormGrp.get('bankName1').setValue(''); isBank1elected = false;">close</mat-icon>
                                      <mat-icon class="mat-icon-close"
                                        (click)="patientDetailsFormGrp.get('bankName1').setValue(''); isBank1elected = false;">search</mat-icon>
                                    </span>
                                    <mat-autocomplete #autoBank1="matAutocomplete" [displayWith]="getOptionTextBank1">
                                      <mat-option *ngFor="let option of filteredOptionsBank1 | async" [value]="option"
                                        >
                                        {{option.BankName}}
                                      </mat-option>
                                    </mat-autocomplete>
                                  </mat-form-field>



                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Registration Date</mat-label>
                                    <input matInput [matDatepicker]="datepickerReg" formControlName="regDate1"
                                        (click)="datepickerReg.open()" [max]="nowDate">
                                    <mat-datepicker-toggle matSuffix [for]="datepickerReg"></mat-datepicker-toggle>
                                    <mat-datepicker #datepickerReg>
                                    </mat-datepicker>
                                </mat-form-field>
                            </ng-container>
                            <div fxFlex="16%">
                                <div [ngClass]="amount1 < netPayAmt ? 'add-icon enable-1-add' : 'add-icon disable-1-add'">
                                    <mat-icon (click)="onAddClick('upi')"> add </mat-icon>
                                </div>
                            </div>
                        </div>
                        <!-- Second Row 2 -->
                        <div fxLayout="row wrap" fxLayoutGap="20px grid" class="field-row" *ngIf="paymentRowObj.upi">
                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Payment Type</mat-label>
                                <mat-select formControlName="paymentType2" [(ngModel)]="selectedPaymnet2"
                                    (selectionChange)="onPaymentChange(2, $event.value)">
                                    <mat-option *ngFor="let ele of paymentArr2" [value]="ele.value">
                                        {{ele.viewValue}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Amount</mat-label>
                                <input matInput formControlName="amount2" (keyup)="getBalanceAmt()" [(ngModel)]="amount2" required>
                                <mat-error *ngIf="patientDetailsFormGrp.get('amount2').hasError('required')">
                                    Required field cannot be left blank
                                </mat-error>
                            </mat-form-field>
                            <ng-container *ngIf="selectedPaymnet2 != 'cash'">
                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Reference Number</mat-label>
                                    <input matInput formControlName="referenceNo2">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('referenceNo2').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Bank Name</mat-label>
                                    <input matInput formControlName="bankName2">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('bankName2').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Registration Date</mat-label>
                                    <input matInput [matDatepicker]="datepickerReg" formControlName="regDate2"
                                        (click)="datepickerReg.open()" [max]="nowDate">
                                    <mat-datepicker-toggle matSuffix [for]="datepickerReg"></mat-datepicker-toggle>
                                    <mat-datepicker #datepickerReg>
                                    </mat-datepicker>
                                    <mat-error *ngIf="patientDetailsFormGrp.get('regDate2').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>
                            </ng-container>
                            <div fxLayout="row" fxLayoutGap="15px" fxFlex="16%">
                                <div class="remove-icon" (click)="onRemoveClick('upi')">
                                    <span>-</span>
                                </div>
                                <div [ngClass]="secondAddEnable() ? 'add-icon enable-1-add' : 'add-icon disable-1-add'" (click)="onAddClick('cheque')">
                                    <mat-icon> add </mat-icon>
                                </div>
                            </div>
                        </div>
                        <!-- Third Row 3 -->
                        <div fxLayout="row wrap" fxLayoutGap="20px grid" class="field-row" *ngIf="paymentRowObj.cheque">
                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Payment Type</mat-label>
                                <mat-select formControlName="paymentType3" [(ngModel)]="selectedPaymnet3"
                                    (selectionChange)="onPaymentChange(3, $event.value)">
                                    <mat-option *ngFor="let ele of paymentArr3" [value]="ele.value">
                                        {{ele.viewValue}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Amount</mat-label>
                                <input matInput formControlName="amount3" (keyup)="getBalanceAmt()" [(ngModel)]="amount3">
                                <mat-error *ngIf="patientDetailsFormGrp.get('amount3').hasError('required')">
                                    Required field cannot be left blank
                                </mat-error>
                            </mat-form-field>
                            <ng-container *ngIf="selectedPaymnet3 != 'cash'">
                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Reference Number</mat-label>
                                    <input matInput formControlName="referenceNo3">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('referenceNo3').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Bank Name</mat-label>
                                    <input matInput formControlName="bankName3">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('bankName3').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Registration Date</mat-label>
                                    <input matInput [matDatepicker]="datepickerRegs" formControlName="regDate3"
                                        (click)="datepickerRegs.open()" [max]="nowDate">
                                    <mat-datepicker-toggle matSuffix [for]="datepickerRegs"></mat-datepicker-toggle>
                                    <mat-datepicker #datepickerRegs>
                                    </mat-datepicker>
                                    <mat-error *ngIf="patientDetailsFormGrp.get('regDate3').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>
                            </ng-container>

                            <div fxLayout="row" fxLayoutGap="15px" fxFlex="16%">
                                <div class="remove-icon" (click)="onRemoveClick('cheque')">
                                    <span>-</span>
                                </div>
                                <div [ngClass]="thirdAddEnable() ? 'add-icon enable-1-add' : 'add-icon disable-1-add'" (click)="onAddClick('card')">
                                    <mat-icon> add </mat-icon>
                                </div>
                            </div>
                        </div>
                        <!-- Fourth Row 4 -->
                        <div fxLayout="row wrap" fxLayoutGap="20px grid" class="field-row" *ngIf="paymentRowObj.card">
                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Payment Type</mat-label>
                                <mat-select formControlName="paymentType4" [(ngModel)]="selectedPaymnet4"
                                    (selectionChange)="onPaymentChange(4, $event.value)">
                                    <mat-option *ngFor="let food of paymentArr4" [value]="food.value">
                                        {{food.viewValue}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Amount</mat-label>
                                <input matInput formControlName="amount4" (keyup)="getBalanceAmt()" [(ngModel)]="amount4">
                            </mat-form-field>
                            <ng-container *ngIf="selectedPaymnet4 != 'cash'">
                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Reference Number</mat-label>
                                    <input matInput formControlName="referenceNo4">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('referenceNo4').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Bank Name</mat-label>
                                    <input matInput formControlName="bankName4">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('bankName4').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Registration Date</mat-label>
                                    <input matInput [matDatepicker]="datepickerRegs" formControlName="regDate4"
                                        (click)="datepickerRegs.open()" [max]="nowDate">
                                    <mat-datepicker-toggle matSuffix [for]="datepickerRegs"></mat-datepicker-toggle>
                                    <mat-datepicker #datepickerRegs>
                                    </mat-datepicker>
                                    <mat-error *ngIf="patientDetailsFormGrp.get('regDate4').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>
                            </ng-container>
                            <div fxLayout="row" fxLayoutGap="15px" fxFlex="16%">
                                <div class="remove-icon" (click)="onRemoveClick('card')">
                                    <span>-</span>
                                </div>
                                <div [ngClass]="fourthAddEnable() ? 'add-icon enable-1-add' : 'add-icon disable-1-add'" (click)="onAddClick('neft')">
                                    <mat-icon> add </mat-icon>
                                </div>
                            </div>
                        </div>
                        <!-- Fifth Row  5 -->
                        <div fxLayout="row wrap" fxLayoutGap="20px grid" class="field-row" *ngIf="paymentRowObj.neft">
                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Payment Type</mat-label>
                                <mat-select formControlName="paymentType5" [(ngModel)]="selectedPaymnet5"
                                    (selectionChange)="onPaymentChange(5, $event.value)">
                                    <mat-option *ngFor="let ele of paymentArr5" [value]="ele.value">
                                        {{ele.viewValue}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>

                            <mat-form-field appearance="outline" fxFlex="16%">
                                <mat-label class="form-field-labels">Amount</mat-label>
                                <input matInput formControlName="amount5" (keyup)="getBalanceAmt()" [(ngModel)]="amount5">
                            </mat-form-field>
                            <ng-container *ngIf="selectedPaymnet5 != 'cash'">
                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Reference Number</mat-label>
                                    <input matInput formControlName="referenceNo5">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('referenceNo5').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Bank Name</mat-label>
                                    <input matInput formControlName="bankName5">
                                    <mat-error *ngIf="patientDetailsFormGrp.get('bankName5').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>

                                <mat-form-field appearance="outline" fxFlex="16%">
                                    <mat-label class="form-field-labels">Registration Date</mat-label>
                                    <input matInput [matDatepicker]="datepickerRegistartion" formControlName="regDate5"
                                        (click)="datepickerRegistartion.open()" [max]="nowDate">
                                    <mat-datepicker-toggle matSuffix
                                        [for]="datepickerRegistartion"></mat-datepicker-toggle>
                                    <mat-datepicker #datepickerRegistartion>
                                    </mat-datepicker>
                                    <mat-error *ngIf="patientDetailsFormGrp.get('regDate5').hasError('required')">
                                        Required field cannot be left blank
                                    </mat-error>
                                </mat-form-field>
                            </ng-container>
                            <div fxLayout="row" fxLayoutGap="15px" fxFlex="16%">
                                <div class="remove-icon" (click)="onRemoveClick('neft')">
                                    <span>-</span>
                                </div>
                            </div>
                        </div>

                    </div>
                <!-- </form> -->
            </fieldset>
        </div>
        <div class="footer-div" fxFlexFill fxLayout="row" fxLayoutAlign="space-between center">
            <div>
                <div>Paid Amount</div>
                <div>
                    <mat-form-field appearance="outline" style="width: 180px;">
                        <mat-label>Paid Amount</mat-label>
                        <input matInput formControlName="paidAmountController" [(ngModel)]="paidAmt" readonly>
                    </mat-form-field>
                    &nbsp;
                    <mat-form-field appearance="outline" style="width: 180px;">
                        <mat-label>Balance Amount</mat-label>
                        <input matInput formControlName="balanceAmountController" [(ngModel)]="balanceAmt" readonly>
                    </mat-form-field>
                </div>
            </div>
            <div style="margin-right: 100px;">
                <button class="next-btn" style="border-radius: 16px;" (click)="saveClicked()">Save</button>
                <button class="footer-btn" (click)="onClose1()" style="border-radius: 16px;">Close</button>
            </div>
        </div>
        </form>
    </fieldset>
</div>