<div id="report-generation" fusePerfectScrollbar class="page-layout simple left-sidebar inner-sidebar inner-scroll">
    <!-- HEADER -->
    <div class="top-header accent" fxLayout="row" fxLayoutAlign="space-between center">
        <div class="top-header-info">
            <div class="top-header-title">
                <span [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}">
                    REPORTS
                </span>
            </div>
        </div>
    </div>

    <!-- CONTENT -->
    <div class="content full-height">
        <div class="center p-24 pb-56 full-height">
            <div class="content-card full-height" fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap="16px">
                <!-- Left Panel (Tree View) -->
                <div fxFlex="35%" fxFlex.xs="100%" fxFlex.sm="50%" class="tree-panel">
                    <mat-card class="tree-card h-100-p">
                        <mat-card-header class="mb-3">
                            <mat-card-title>Report Categories</mat-card-title>
                        </mat-card-header>
                       <mat-divider></mat-divider>
                        <mat-card-content>
                            <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="example-tree">
                                <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding (click)="GetReportDeails(node)" [class.selected]="selectedNode === node">
                                    <button mat-icon-button></button>
                                    {{node.name }}
                                </mat-tree-node>
                                <mat-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>
                                    <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
                                        <mat-icon class="mat-icon-rtl-mirror">
                                            {{ treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
                                        </mat-icon>
                                    </button>
                                    {{ node.name }}
                                </mat-tree-node>
                            </mat-tree>
                        </mat-card-content>
                    </mat-card>
                </div>

                <!-- Right Panel (Form) -->
                <div fxFlex="75%" fxFlex.xs="100%" fxFlex.sm="50%" class="form-panel" [ngClass]="{'disabled-div': !ReportName}">
                    <mat-card class="form-card h-100-p">
                        <mat-card-header class="mb-3">
                            <mat-card-title>Report Details</mat-card-title>
                        </mat-card-header>

                       <mat-divider></mat-divider>
                        <mat-card-content>
                            <form [formGroup]="_ReportService.userForm" class="report-form" fusePerfectScrollbar>
                                <!-- Report & User Info -->
                                <div class="report-header my-12" fxLayout="row" fxLayoutAlign="space-between center">
                                    <span class="h2">Selected Report: <strong>{{ ReportName }}</strong></span>
                                    <span class="h2">Current User: <strong>{{ UId }} | {{ UserName }}</strong></span>
                                </div>

                                <!-- Date Range -->
                                <div fxLayout="row" fxLayoutAlign="start none">
                                    <mat-form-field appearance="outline" class="date-field full-width">
                                        <mat-label>Enter a date range</mat-label>
                                        <mat-date-range-input [rangePicker]="picker">
                                            <input matStartDate formControlName="StartDate" placeholder="Start date">
                                            <input matEndDate formControlName="EndDate" placeholder="End date">
                                        </mat-date-range-input>
                                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-date-range-picker #picker></mat-date-range-picker>
                                    </mat-form-field>
                                </div>

                                <!-- AutoComplete Fields -->
                                <div fxLayout="column" fxLayoutAlign="start none" class="autocomplete-section">
                                    <ng-container *ngIf="flagUserSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="User" [formGroup]="_ReportService.userForm" formControlName="UserId" placeholderText="Enter User" ApiUrl="Report/UserList/auto-complete?Keyword=" (selectionChange)="SelectedUserObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="flagDoctorSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Doctor" [formGroup]="_ReportService.userForm" formControlName="DoctorId" placeholderText="Enter Doctor" ApiUrl="Report/DoctorList/auto-complete?Keyword=" (selectionChange)="SelectedDoctorObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="flagServiceSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Service Name" [formGroup]="_ReportService.userForm" formControlName="ServiceId" placeholderText="Enter Service Name" ApiUrl="Report/ServiceList/auto-complete?Keyword=" (selectionChange)="SelectedServiceObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="flagDepartmentSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Department Name" [formGroup]="_ReportService.userForm" formControlName="DepartmentId" placeholderText="Enter Department Name" ApiUrl="Report/DepartmentList/auto-complete?Keyword=" (selectionChange)="SelectedDepartmentObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="flagCashcounterSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Cash Counter" [formGroup]="_ReportService.userForm" formControlName="CashCounterId" placeholderText="Enter Cash Counter" ApiUrl="Report/CashCounterList/auto-complete?Keyword=" (selectionChange)="SelecteCashCounterObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagGroupSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Group Name" [formGroup]="_ReportService.userForm" formControlName="GroupId" placeholderText="Select Group Name" ApiUrl="Report/GroupMasterList/auto-complete?Keyword=" (selectionChange)="SelectedGroupObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagClassSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Class Name" [formGroup]="_ReportService.userForm" formControlName="ClassId" placeholderText="Select Class Name" ApiUrl="Report/ClassMasterList/auto-complete?Keyword=" (selectionChange)="SelectedClassObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagWardSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Ward Name" [formGroup]="_ReportService.userForm" formControlName="WardId" placeholderText="Select Ward Name" ApiUrl="Report/WardList/auto-complete?Keyword=" (selectionChange)="SelectedWardObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagDischargeTypeSelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Discharge Type" [formGroup]="_ReportService.userForm" formControlName="dischargeTypeId" placeholderText="Select Discharge Type" ApiUrl="Report/DischargeTypeList/auto-complete?Keyword=" (selectionChange)="SelectedDischargeObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagCompanySelected">
                                         <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Company Name" [formGroup]="_ReportService.userForm" formControlName="CompanyId" placeholderText="Select Company Name" ApiUrl="Report/CompanyList/auto-complete?Keyword=" (selectionChange)="SelectedCompanyObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagStoreSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Store Name" [formGroup]="_ReportService.userForm" formControlName="StoreId" placeholderText="Select Store Name" ApiUrl="Report/MStoreMasterList/auto-complete?Keyword=" (selectionChange)="SelectedStoreObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagSupplierelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Supplier Name" [formGroup]="_ReportService.userForm" formControlName="SupplierId" placeholderText="Select Supplier Name" ApiUrl="Report/MSupplierMasterList/auto-complete?Keyword=" (selectionChange)="SelectedSupplierObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagPaymentSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Payment Mode" [formGroup]="_ReportService.userForm" formControlName="PaymentId" placeholderText="Select Payment Mode" ApiUrl="Report/PaymentList/auto-complete?Keyword=" (selectionChange)="SelectedPaymentObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>

                                    <ng-container *ngIf="flagDrugTypeSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Drug Type" [formGroup]="_ReportService.userForm" formControlName="DrugTypeId" placeholderText="Select Drug Type" ApiUrl="Report/MItemDrugTypeMasterList/auto-complete?Keyword=" (selectionChange)="SelectedDrugTypeObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    
                                    <ng-container *ngIf="flagItemSelected">
                                        <div style="max-width: 265px;">
                                            <airmid-autocomplete label="Item Name" [formGroup]="_ReportService.userForm" formControlName="ItemId" placeholderText="Select Item Name" ApiUrl="Report/MItemMasterList/auto-complete?Keyword=" (selectionChange)="SelectedItemObj($event)">
                                            </airmid-autocomplete>
                                        </div>
                                    </ng-container>
                                    <!-- Creadit Reason & sales dd remaining -->
                                </div>

                                <div fxLayout="row" fxLayoutAlign="start none">
                                    <span *ngIf="flagOPIPTypeSelected"
                                            style="font-weight: bold;margin-left: 2%;">Patient Type</span>
                                        <mat-radio-group aria-label="Select an option" formControlName="OPIPType"
                                            *ngIf="flagOPIPTypeSelected" style="margin-left:2%;" name="OPIPType">

                                            <mat-radio-button value="0">OP</mat-radio-button>
                                            <mat-radio-button value="1">IP</mat-radio-button>                                            
                                            <mat-radio-button value="2">All</mat-radio-button>
                                        </mat-radio-group>
                                </div>

                                <!-- Print Button -->
                                <div fxLayout="row" fxLayoutAlign="start none">
                                    <button mat-fab extended color="primary" [disabled]="!ReportName" (click)="GetPrint()">
                                        <mat-icon>print</mat-icon>
                                        <span>Print</span>
                                    </button>
                                </div>
                            </form>
                        </mat-card-content>
                    </mat-card>
                </div>
            </div>
        </div>
    </div>
</div>
