<div class="dashboard-project" class="page-layout simple right-sidebar" fxLayout="row">

    <!-- CENTER -->
    <div class="center">
        <div class="header h-100 accent pb-0 p-12" fxLayout="row" fxFlex="100%" fxLayoutAlign="space-between start">

            <div fxLayout="row" fxLayoutAlign="space-between center">
                <button mat-icon-button class="sidebar-toggle mr-12" style="color: white;">
                    <mat-icon>menu</mat-icon>
                </button>

                <span class="mat-display-1 my-0 my-sm-12 welcome-message"
                    [@animate]="{value:'*',params:{delay:'100ms',x:'-25px'}}" style="color: white;">
                    Pharmacy Dashboard
                </span>
            </div>
            <form [formGroup]="_DashboardService.UseFrom"  >
                
                <!-- <mat-card class="h-80  p-2 accent" fxLayout="row" fxFlex="270px" style=" color: black;padding: 10px;"> -->
                   
                    <mat-form-field appearance="outline" fxFlex="270px">
                        <mat-label style="color: white;">Select Store</mat-label>
                        <mat-select formControlName="StoreId" name="StoreId">
                            <mat-option></mat-option>
                            <mat-option  *ngFor="let m of PharmStoreList" [value]="m" (selectionChange)="fetchChartData($event)">
                                {{m.StoreName}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>&nbsp;&nbsp;
                <!-- </mat-card>&nbsp;&nbsp; -->
 
                <!-- <mat-card class="h-80  p-2 accent" fxLayout="row" fxFlex="270px" style=" color: black;padding: 10px;"> -->
                    <mat-form-field appearance="outline" fxFlex>
                        <mat-label >Enter a date range</mat-label>
                        <mat-date-range-input [rangePicker]="picker">
                            <input matStartDate formControlName="start" placeholder="Start date">
                            <input matEndDate formControlName="end" placeholder="End date" 
                                (dateChange)="onDateRangeChanged()">
                        </mat-date-range-input>
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-date-range-picker #picker></mat-date-range-picker>
                    </mat-form-field>

                <!-- </mat-card> -->
            </form>
        </div>
        <!-- 
            m_PharCollectionSummaryDashboard && m_pharlast3MonthSalesSummaryDashboard
         -->
        <div class="dashboard-container" fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="50%">
                <mat-card class="chart-card">
                    <mat-card-header>
                        <div class="card-hearder">
                            <mat-card-title>Static</mat-card-title>
                            <mat-form-field>
                                <mat-select [(value)]="selectedStatic" (selectionChange)="onChangeStatic($event)">
                                  <mat-option *ngFor="let option of staticOptions" [value]="option.value">
                                    {{ option.viewValue }}
                                  </mat-option>
                                </mat-select>
                              </mat-form-field>
                        </div>
                    </mat-card-header>
                    <hr>
                    <mat-card-content>
                        <mat-spinner *ngIf="sIsLoading === 'pharSumChartLoading'"></mat-spinner>
                        <div fxLayout="row" fxLayoutAlign="space-between">
                            <canvas id="doughnutChart" style="width: 100%;"></canvas>
                            <!-- <canvas baseChart [datasets]="PiechartData5" [labels]="labelData"
                                [options]="pieChartOptions" legend="true"
                                chartType="doughnut">
                            </canvas> -->
                            <!-- <table class="table1" fxFlex="100%" style="border-collapse: collapse;">
                                <tbody>
                                    <tr style="font-size:12px;">
                                        <td colspan="5"
                                            style="background-color: rgb(37, 174, 192); font-weight:bold;text-align:left;padding:10px;font-size: 18px;color: white;">
                                            Statistics</td>
                                    </tr>
                                    <tr style="font-size:12px;">
                                        <td colspan="3"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;">
                                            Collection</td>
                                        <td colspan="2"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;padding-left: 20px;">
                                            {{getTotalCollectionAmt(dsPharmacyDashboard.data) | currency:'INR'}}</td>
                                    </tr>
                                    <tr style="font-size:12px;">
                                        <td colspan="3"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;">
                                            Refund</td>
                                        <td colspan="2"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;padding-left: 20px;">
                                            {{getTotalRefunAmt(dsPharmacyDashboard.data) | currency:'INR'}}</td>
                                    </tr>
                                    <tr style="font-size:12px; background-color:#2a6392;color: white;">
                                        <td colspan="3"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;">
                                            Net</td>
                                        <td colspan="2"
                                            style="font-weight:bold;text-align:left;padding:10px;font-size: 16px;">
                                            {{getTotalNetAmt(dsPharmacyDashboard.data) | currency:'INR' }}</td>
                                    </tr>
                                    <tr style="font-size:12px;">
                                        <td colspan="4" style="background-color: white;text-align:left;padding:8px;">
                                        </td>
                                    </tr>
                                    <tr style="font-size:12px;background-color:#2a6392;color: white;font-size: 15px;">
                                        <td style="font-weight:bold;text-align:left;padding:10px;">
                                            StoreName</td>
                                        <td style="font-weight:bold;text-align:left;padding:10px;">
                                            BillCount</td>
                                        <td style="font-weight:bold;text-align:left;padding:10px;">
                                            Collection Amount</td>
                                        <td style="font-weight:bold;text-align:left;padding:10px;">
                                            Refund Amount</td>
                                        <td style="font-weight:bold;text-align:left;padding:10px;">
                                            Net Amount</td>
                                    </tr><br>
                                    <tr *ngFor="let item of PharmacyDashboard; let indx = index;" style="font-size:13px;
                                    border: 1px solid black;">

                                        <td style="padding: 10px;background-color: lightgray;
                                        text-align: left;color: black;" class="StoreName">{{item?.StoreName}}</td>
                                        <td style="padding: 10px;background-color: lightgray;
                                        text-align: right;color: black;" class="StoreName">{{item?.BillCount}}</td>
                                        <td style="padding: 10px;background-color: lightgray;
                                        text-align: right;color: black;">{{item?.CollectionAmount | number:'1.2-2' }}</td>
                                        <td style="padding: 10px;background-color: lightgray;
                                        text-align: right;color: black;">{{item?.RefundAmount | number:'1.2-2'}}</td>
                                        <td style="padding: 10px;background-color: lightgray;
                                        text-align: right;color: black;">{{item?.NetAmount | number:'1.2-2'}}</td>
                                    </tr><br>


                                </tbody>
                            </table> -->
                        </div> 
                        <div *ngIf="sIsLoading === 'noPharSumData'">
                            <h3>No Data</h3>
                        </div>   
                    </mat-card-content>
                </mat-card>
            </div>

            <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="50%">
                <mat-card class="chart-card">
                    <mat-card-header>
                        <div class="card-hearder">
                            <mat-card-title>3 Months Sales Summary Data</mat-card-title>
                            <!-- <mat-form-field>
                                <mat-select [(value)]="selectedStatic" (selectionChange)="onChangeStatic($event)">
                                  <mat-option *ngFor="let option of staticOptions" [value]="option.value">
                                    {{ option.viewValue }}
                                  </mat-option>
                                </mat-select>
                              </mat-form-field> -->
                        </div>
                    </mat-card-header>
                    <hr>
                    <mat-card-content>
                        <div *ngIf="threeMonSalesData && threeMonSalesData.length > 0">
                            <canvas baseChart [datasets]="threeMonSalesData" [labels]="threeMonSalesLabels"
                                [options]="barChartOptions" [legend]="barChartLegend"
                                [chartType]="barChartType">
                            </canvas>
                        </div>
                        <!-- <canvas id="pharSumBarChart" style="width: 100%;"></canvas> -->
                    </mat-card-content>
                </mat-card>
            </div>

        </div>

        <!-- 
            m_pharlast3MonthCollectionSummaryDashboard && m_pharCurStockValueSummaryDashboard
         -->
        <div class="dashboard-container" fxLayout="row wrap" fxLayoutGap="20px grid">
            <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="50%">
                <mat-card class="chart-card">
                    <mat-card-header>
                        <div class="card-hearder">
                            <mat-card-title>3 Month Collection Data</mat-card-title>
                        </div>
                    </mat-card-header>
                    <hr>
                    <mat-card-content>
                        <mat-spinner *ngIf="isCollectionLoad === 'pharCollectionChartLoading'"></mat-spinner>
                        <div fxLayout="row" fxLayoutAlign="space-between" *ngIf="isCollectionLoad === 'pharCollectionChartLoaded'">
                            <canvas baseChart [datasets]="threeMonCollectionData" [labels]="threeMonCollectionLabels"
                                [options]="barChartOptions" [legend]="barChartLegend"
                                [chartType]="barChartType">
                            </canvas>
                            <!-- <canvasjs-chart [options]="chartJsOptions"></canvasjs-chart> -->
                        </div>    
                    </mat-card-content>
                </mat-card>
            </div>

            <div fxFlex="50%" fxFlex.xs="100%" fxFlex.sm="50%">
                <mat-card class="chart-card">
                    <mat-card-header>
                        <div class="card-hearder">
                            <mat-card-title>Phar Cust Stock Value</mat-card-title>
                        </div>
                    </mat-card-header>
                    <hr>
                    <mat-card-content>
                        <div *ngIf="pharCustStockData && pharCustStockData.length > 0">
                            <!-- <canvas baseChart [datasets]="pharCustStockData" [labels]="pharCustStockLabels"
                                [options]="barChartOptions" [plugins]="barChartPlugins" [legend]="barChartLegend"
                                [chartType]="barChartType">
                            </canvas> -->
                            <canvas baseChart [datasets]="pharCustStockData" [labels]="pharCustStockLabels"
                                [options]="pieChartOptions" legend="true"
                                chartType="doughnut">
                            </canvas>
                        </div>
                    </mat-card-content>
                </mat-card>
            </div>
        </div>

        <div class="dashboard-container" fxLayout="row wrap" fxLayoutGap="30px grid">
            <div fxFlex="35%" fxFlex.xs="100%" fxFlex.sm="33%">

                <mat-card class="h-340 p-10">
                    <div class="p-5">
                        <div fxLayout="row" fxLayoutAlign="space-between start">
                            <span style="font-size: 30px; font-weight:400px;">Net
                                Sales
                                <mat-icon style="color: gray;">circle_information</mat-icon></span>
                            <span style="font-size: 20px; font-weight: bold;color: rgb(22, 239, 167);">
                                <mat-icon>carrow_upward</mat-icon>11.3%</span>
                        </div>
                    </div>


                    <div fxLayout="row" fxLayoutAlign="space-between">
                        <span style="margin-top: 10px;font-weight: bold;font-size: 25px;">
                            <mat-icon style="font-weight: bold;">&#8377;</mat-icon>{{Totalamount }}
                            <span style="margin-top:10px;font-size: 15px;font-weight:200px;color: gray;">from
                                <mat-icon
                                    style="font-size: 15px;margin-left: 5px;color: gray;">&#8377;</mat-icon>{{GrossAmount}}
                            </span>
                        </span>

                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start" style="height: 100px;">
                        <!-- <canvas id="BarChart" style="width: 100%;"></canvas> -->

                        <div class="chart-wrapper" fxFlex style="height: 300px;">
                            <!-- <canvas baseChart [datasets]="barChartData" [labels]="barChartLabels"
                                [options]="barChartOptions" [plugins]="barChartPlugins" [legend]="barChartLegend"
                                [chartType]="barChartType">
                            </canvas> -->
                        </div>
                    </div>


                </mat-card>
            </div>

            <div fxFlex="22%" fxFlex.xs="100%" fxFlex.sm="33%">
                <mat-card class="h-340 p-10">
                    <div fxLayout="row" fxLayoutAlign="space-between start">
                        <span style="font-size: 30px; font-weight:400px;">Stock
                            Value<mat-icon style="color: gray;">circle_information</mat-icon>
                        </span><br><br>

                    </div>
                    <div fxLayout="column" fxLayoutAlign="space-between start">
                        <span style="font-size: 15px;font-weight:200px;color: gray;">
                            Purcjase Rate (excl gst) </span>
                        <span style="font-weight: bold;font-size: 18px;">
                            <mat-icon style="font-weight: bold;">&#8377;</mat-icon>{{Totalamount}}
                        </span>
                    </div> <br>


                    <div fxLayout="column" fxLayoutAlign="space-between end" style="color: gray;">
                        <span style="font-size: 15px;font-weight:200px;">MRP (incl gst) </span>
                        <span style="font-weight:200px;font-size: 18px;">
                            <mat-icon style="font-weight:200px;">&#8377;</mat-icon>{{Totalamount}}
                        </span><br>

                        <span style="font-size: 15px;font-weight:200px;">Sale Rate (incl gst) </span>
                        <span style="font-weight:200px;font-size: 18px;">
                            <mat-icon style="font-weight:200px;">&#8377;</mat-icon>{{Totalamount}}
                        </span>

                    </div>
                </mat-card>
            </div>

            <div fxFlex="35%" fxFlex.xs="100%" fxFlex.sm="33%">
                <mat-card class="h-340 p-10">
                    <div fxLayout="row" fxLayoutAlign="space-between start">
                        <span style="font-size: 30px; font-weight:400px;">Customers

                            <mat-icon style="color: gray;">circle_information</mat-icon></span>
                        <span style="font-size: 20px; font-weight: bold;color: rgb(22, 239, 167);">
                            <mat-icon>carrow_upward</mat-icon>11.3%</span>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start" style="padding: 8px;">
                        <div fxLayout="column" fxLayoutAlign="space-between start">
                            <span style="font-size: 15px;font-weight:100px;color: gray;">Total
                                Customers</span>
                            <span style="font-weight: bold;font-size: 25px;">
                                {{TotalCustomers}}
                            </span>
                        </div>
                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            <span style="font-size: 15px;font-weight:100px;color: gray;">Avg Order
                                Value</span>
                            <span style="font-size: 25px;font-weight:bold;">
                                <mat-icon
                                    style="font-size: 25px;font-weight: bold;">&#8377;</mat-icon>{{AverageOrderValue}}
                            </span>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between">

                        <div fxFlex="90%">
                            <canvas baseChart [data]="pieChartData" [chartType]="pieChartType" [labels]="pieChartLabels"
                                [options]="pieChartOptions"></canvas>
                        </div>

                    </div>



                </mat-card>
            </div>
        </div>

        <div class="dashboard-container" fxLayout="row wrap" fxLayoutGap="30px grid">
            <div fxFlex="35%" fxFlex.xs="100%" fxFlex.sm="33%">
                <mat-card class="h-340 p-8">
                    <div fxLayout="row" fxLayoutAlign="space-between">
                        <span style="font-size: 30px; font-weight:400px;">Net Purchase
                            <mat-icon style="color: gray;">circle_information</mat-icon></span>
                        <span style="font-size: 20px; font-weight: bold;color: rgb(22, 239, 167);">
                            <mat-icon>carrow_downward</mat-icon>11.3%</span>
                    </div>


                    <div fxLayout="column" fxLayoutAlign="space-between start">
                        <span style="margin-top: 10px;font-weight: bold;font-size: 25px;">
                            <mat-icon style="font-weight: bold;">&#8377;</mat-icon>{{Totalamount}}
                            <span style="font-size: 15px;font-weight:200px;color: gray;">from
                                <mat-icon style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{GrossAmount}}
                            </span>
                        </span>

                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start">
                        <canvas baseChart [datasets]="chartData1" [labels]="chartLabels1" [options]="chartOptions1"
                            [chartType]="'line'">
                        </canvas>
                    </div>

                </mat-card>
            </div>

            <div class="MatcardContent" fxFlex="57%" fxFlex.xs="100%" fxFlex.sm="33%" style="margin-bottom: 10px;">
                <mat-card class=" h-340 p-10">

                    <div fxLayout="row" fxLayoutAlign="space-between start">
                        <span style="font-size: 30px; font-weight:400px;">Cash-In-Hand
                            <mat-icon style="color: gray;">circle_information</mat-icon></span>

                        <span style="font-size:22px; font-weight:bold;color: rgb(245, 78, 134);">Add
                            Opening Balance</span>
                        <span style="font-size: 20px; font-weight: bold;color: rgb(22, 239, 167);">
                            <mat-icon>carrow_downward</mat-icon>11.3%</span>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 10px;margin-left: 10px;">
                        <span style="font-weight: bold;font-size: 25px;">
                            <mat-icon style="font-weight: bold;">&#8377;</mat-icon>{{Totalamount}}
                            <span style="font-size: 15px;font-weight:200px;color: gray;">from
                                <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{GrossAmount}}
                            </span>
                        </span>

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            {{progressValue}}
                            <span><mat-progress-bar mode="determinate" value="75"
                                    fxFlex="200px"></mat-progress-bar></span>
                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top:8px;">
                                CASH <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Cash}}</span>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 0px;">
                        <div>
                            <span style="font-weight: 200px;font-size: 18px;color: gray;">
                                Total Payment In</span><br>
                            <span style="font-size: 15px;font-weight:200px;">
                                <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Totalamount}}
                            </span>
                        </div>

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            {{progressValue1}}
                            <span> <mat-progress-bar mode="determinate" value="40"
                                    fxFlex="200px"></mat-progress-bar></span>

                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top:8px;">
                                ONLINE <mat-icon
                                    style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{Online}}</span>
                        </div>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 5px;">
                        <div fxLayout="column" style="margin-right: 10px;">
                            <span style="font-weight: 100px;font-size: 18px;color: gray;">
                                Total Payment <br>Out</span>
                            <span style="margin-top:6px;;font-size: 15px;font-weight:100px;">
                                <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Totalamount}}
                            </span>
                        </div>

                        <div class="vertical-line"></div>

                        <div fxLayout="column" fxLayoutAlign="space-between start">
                            <span style="font-weight: 100px;font-size: 18px;color: gray;">
                                Expenses (excl gst)</span>
                            <span style="margin-top:6px;;font-size: 15px;font-weight:bold;">
                                <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Totalamount}}
                            </span>
                        </div>

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            {{progressValue2}}
                            <span> <mat-progress-bar mode="determinate" value="12"
                                    fxFlex="200px"></mat-progress-bar></span>

                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top: 8px;">
                                CHEQUE <mat-icon
                                    style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{Cheque}}</span>
                        </div>
                    </div>



                    <!-- <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 25px;">

                        <span style="font-weight: bold;font-size: 25px;">
                            <mat-icon style="font-weight: bold;">&#8377;</mat-icon>{{Totalamount}}
                            <span style="font-size: 15px;font-weight:200px;color: gray;">from
                                <mat-icon style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{GrossAmount}}
                            </span>
                        </span>
                        

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            <div fxLayout="row" fxLayoutAlign="space-between end">
                                {{progressValue}}
                                <mat-progress-bar mode="determinate" value="75" fxFlex="200px"></mat-progress-bar>
                            </div>
                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top:10px;">
                                CASH <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Cash}}</span>

                        </div>
                    </div> -->



                    <!-- <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 20px;">
                        <div fxLayout="column" fxLayoutAlign="space-between start">
                            <span style="font-weight: 200px;font-size: 18px;color: gray;">
                                Total Payment In</span>
                            <span style="font-size: 15px;font-weight:200px;">
                                <mat-icon style="font-size: 15px;">&#8377;</mat-icon>{{Totalamount}}
                            </span>

                        </div>

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            <div fxLayout="row" fxLayoutAlign="space-between start">
                                {{progressValue1}} <mat-progress-bar mode="determinate" value="40"
                                    fxFlex="50%"></mat-progress-bar>
                            </div>
                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top:10px;">
                                ONLINE <mat-icon
                                    style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{Online}}</span>
                        </div>
                    </div> -->


                    <!-- <div fxLayout="row" fxLayoutAlign="space-between start" style="margin-top: 20px;">
                        <div fxLayout="column" style="margin-right: 10px;">
                            <span style="font-weight: 100px;font-size: 18px;color: gray;">
                                Total Payment Out</span>
                            <span style="margin-top:10px;;font-size: 15px;font-weight:100px;">
                                <mat-icon style="font-size: 15px;margin-left: 5px; ">&#8377;</mat-icon>{{Totalamount}}
                            </span>
                        </div>

                        <div class="vertical-line"></div>

                        <div fxLayout="column" fxLayoutAlign="space-between start">
                            <span style="font-weight: 100px;font-size: 18px;color: gray;">
                                Expenses (excl gst)</span>
                            <span style="margin-top:10px;;font-size: 15px;font-weight:bold;">
                                <mat-icon style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{Totalamount}}
                            </span>
                        </div>

                        <div fxLayout="column" fxLayoutAlign="space-between end">
                            <div fxLayout="row" fxLayoutAlign="space-between">
                                {{progressValue2}}
                                <mat-progress-bar mode="determinate" value="12" fxFlex="50%"></mat-progress-bar>
                            </div>
                            <span style="font-weight: 100px;font-size: 18px;color: gray;margin-top: 10px;">
                                CHEQUE <mat-icon
                                    style="font-size: 15px;margin-left: 5px;">&#8377;</mat-icon>{{Cheque}}</span>
                        </div>
                    </div> -->

                </mat-card>

            </div>
        </div>
    </div>
</div>