<div hidden class="bill-template-wrapper2" style="font-size: 30.25%" #billTemplate2>
  <div style="display: flex; align-items: center; margin-bottom: 10px">
    <!-- <span style="font-size: 8px;font-weight: 700;width: 33.33%;">(A Unit of Shri Siddeshwar Loka Kalyana Charitable
            Trust)</span> -->
    <h4 style="text-transform: uppercase; font-weight: 500; margin: 0; width: 66.33%; text-align: center; margin-left: 100px">{{ type }} &nbsp; Tax Invoice</h4>
  </div>

  <table class="table" style="width: 100%; border-collapse: collapse">
    <tbody>
      <tr>
        <td colspan="4" style="vertical-align: top; border: 1px solid black; width: 40%; padding: 0 10px 10px; font-size: 10px">
          <h3 style="margin-top: 0; margin-bottom: 5px; color: #e26d14; text-transform: uppercase; font-size: 10px">
            {{ reportPrintObjList[0]?.StoreName }}
          </h3>

          <div>{{ reportPrintObjList[0]?.StoreAddress }}</div>
          <!-- <div>GST No. 29ABCTS6874R1Z8</div>
                    <div>
                        <span style="margin-right: 20px;">D.L.No. 123456789456123</span>
                        <span>D.L.No. 123456789456123</span>
                    </div> -->
          <div>
            <a href="tel:08352259399" style="margin-right: 20px">{{ reportPrintObjList[0]?.HospitalMobileNo }}</a>
            <a href="mailto:info@jsshospitals.com">{{ reportPrintObjList[0]?.HospitalEmailId }}</a>
          </div>
        </td>
        <td colspan="6" style="border: 1px solid black; width: 33.33%; vertical-align: top; padding: 0">
          <table style="width: 100%; border-collapse: collapse; font-size: 10px">
            <!-- <tr> -->
            <td style="vertical-align: top; padding: 0 10px 10px">
              Customer Id : {{ reportPrintObjList[0]?.RegNo }}
              <br />
              Customer Name: {{ reportPrintObjList[0]?.PatientName }}
              <br />
              Age & Gen: -
              <span style="margin-left: 10px">Mob: {{ reportPrintObjList[0]?.ExtMobileNo }}</span>
              <br />
              Doctor Name: {{ reportPrintObjList[0]?.DoctorName }}
            </td>
            <!-- </tr> -->
          </table>
        </td>
        <!-- <td>
                </td> -->
      </tr>
      <tr>
        <td colspan="4" style="vertical-align: top; border: 1px solid black; width: 40%; padding: 0 10px 10px; font-size: 10px">
          <div>GST No. {{ reportPrintObjList[0]?.GSTIN }}</div>
          <div>
            <span style="margin-right: 20px">D.L.No. {{ reportPrintObjList[0]?.DL_NO }}</span>
            <!-- <span>D.L.No. {{reportPrintObjList[0]?.DL_NO}}</span> -->
          </div>
        </td>
        <td colspan="6" style="border: 1px solid black; width: 33.33%; vertical-align: top; padding: 0">
          <table style="width: 100%; font-size: 10px">
            <!-- <tr> -->
            <td style="vertical-align: top; padding: 0 10px 10px">
              Bill No: {{ reportPrintObjList[0]?.SalesNo }}
              <span style="margin-left: 10px">Bill Date:{{ reportPrintObjList[0]?.Time | date : 'dd/MM/yyyy h:mm' }} | {{ reportPrintObjList[0]?.Time | date : 'H:mm' }}</span>
              <br />
              Mode of Payment : {{ reportPrintObjList[0]?.PayMode }}
              <br />
            </td>
            <!-- </tr> -->
          </table>
        </td>
      </tr>

      <tr style="font-size: 10px">
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">Sr No.</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">HSN</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">MFR</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 100px">Product Name</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">Pack</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 35px">Batch No.</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">ExpDate</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">Qty</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 15px">MRP</td>
        <td style="border: 1px solid black; font-weight: bold; text-align: center; vertical-align: middle; padding: 5px 5px; width: 35px">Amount</td>
      </tr>
      <tr *ngFor="let item of reportPrintObjList; let indx = index" style="font-size: 10px">
        <td style="border-left: 1px solid black; text-align: center; vertical-align: middle; padding: 0; height: 10px">{{ indx + 1 }}</td>
        <td style="border-left: 1px solid black; padding: 0; height: 10px">{{ item?.HSNcode }}</td>
        <td style="border-left: 1px solid black; padding: 0; height: 10px">{{ item.ManufShortName }}</td>
        <td style="border-left: 1px solid black; padding: 0; height: 10px">{{ item?.ItemName }}</td>
        <td style="border-left: 1px solid black; text-align: center; padding: 0; height: 10px">{{ item?.ConversionFactor }}</td>
        <td style="border-left: 1px solid black; text-align: center; padding: 0; height: 10px">{{ item?.BatchNo }}</td>
        <td style="border-left: 1px solid black; text-align: center; padding: 0; height: 10px">{{ item?.BatchExpDate | date : 'MM/yyyy' }}</td>
        <td style="border-left: 1px solid black; text-align: center; vertical-align: middle; padding: 0; height: 10px">{{ item?.Qty }}</td>
        <td style="border-left: 1px solid black; text-align: center; vertical-align: middle; padding: 0; height: 10px">{{ item?.UnitMRP }}</td>
        <td style="border-left: 1px solid black; border-right: 1px solid black; vertical-align: middle; text-align: center; padding: 3px; height: 10px">{{ item?.TotalAmount }}</td>
      </tr>
      <tr>
        <td colspan="6" style="border: 1px solid black; vertical-align: top; padding: 0 10px 10px">
          <div style="font-weight: 400">Terms & Conditions</div>
          <ul style="margin: 5px 0 0 0; font-size: 10px; padding-left: 17px; font-weight: 400">
            <li>Please check the item before leaving medical.</li>
            <li>Please consult your doctor before consuming the medicine</li>
            <li>All disputes are subject to Solapur jurisdiction only</li>
          </ul>
        </td>
        <!-- <td colspan="5" style="border: 1px solid black;vertical-align: top;padding: 0;"> 
                </td> -->
        <td colspan="9" style="border: 1px solid black; vertical-align: top; padding: 0 10px 10px; width: 300px; font-size: 10px">
          <div style="display: flex; align-items: center">
            <span style="width: 90px; display: inline-block">Sub Total</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.HTotalAmount }}</span>
          </div>
          <div style="display: flex; align-items: center">
            <span style="width: 90px; display: inline-block">Discount</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.DiscAmount }}</span>
          </div>
          <div style="display: flex; align-items: center">
            <span style="width: 90px; display: inline-block">Total GST</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.CGSTAmt + reportPrintObjList[0]?.SGSTAmt + reportPrintObjList[0]?.IGSTAmt }}</span>
          </div>
          <div style="display: flex; align-items: center">
            <span style="width: 90px; display: inline-block">Round off</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.RoundOff }}</span>
          </div>

          <div style="display: flex; align-items: center; font-size: 12px; font-weight: bold">
            <span style="display: inline-block">Grand Total</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.PaidAmount }}</span>
          </div>

          <div style="display: flex; align-items: center; font-size: 12px; font-weight: bold" *ngIf="Creditflag">
            <span style="display: inline-block">Balance Amount</span>
            <span style="margin: 0 5px">:</span>
            <span>₹ {{ reportPrintObjList[0]?.NetAmount }}</span>
          </div>
        </td>
      </tr>
      <tr style="font-size: 10px">
        <td colspan="3">Billed By: {{ reportPrintObjList[0]?.UserName }}</td>
        <td colspan="10" style="text-align: right">This is Computer generated invoice hence doesn’t require signature</td>
      </tr>
      <tr style="font-size: 10px">
        <td colspan="3" style="padding-top: 50px">Note :- Get Well Soon</td>
        <td colspan="10" style="text-align: right; padding-top: 50px">Pharmacist</td>
      </tr>
    </tbody>
  </table>

  <!-- <div style="font-style: italic; opacity:.6;text-align: center;font-size: 10px; margin-top: 15px;">
        This is Computer generated invoice hence doesn’t require signature
    </div> -->
</div>

<!-- NEW -->

<div class="modal-page page-layout inner-scroll">
  <div class="modal-wrapper grid-container">
    <!-- Modal header -->
    <div class="modal-header accent">
      <div class="modal-header-content">
        <div class="modal-header-title">
          <span [@animate]="{ value: '*', params: { delay: '100ms', x: '-25px' } }">
            Sales:  
            <b>{{ StoreName }}</b>
          </span>
        </div>
        <div class="modal-header-right">
          <div class="comman-date-container">
            <app-common-date [screenFrom]="screenFromString" (dateTimeEventEmitter)="getDateTime($event)"></app-common-date>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal body -->
    <div class="modal-body" fusePerfectScrollbar>
      <div fxLayout="column" fxLayout.gt-xs="row" class="gap-12 h-100-p">
        <div fxFlex="80%" fxFlex.sm="70%" fxFlex.xs="100%" class="table-left">
          <div class="modal-body-container">
            <div fxLayout="column" class="gap-8 h-100-p">
              <div class="modal-card-container search-container">
                <div class="patient-search-container input-error-hidden">
                  <mat-card fxFlex.gt-sm="100%" fxFlex>
                    <mat-card-content>
                      <form [formGroup]="ItemSubform" class="pt-0">
                        <div fxFlexFill fxLayout="column" fxLayout.gt-xs="row" fxLayoutAlign="space-between" class="gap-8">
                          <div class="radio-group-left gap-8" fxLayout="row" fxLayoutAlign="start center" fxFlex>
                            <mat-radio-group
                              aria-label="Select an option"
                              formControlName="PatientType"
                              [(ngModel)]="vSelectedOption"
                              name="paymode"
                              (change)="onChangePatientType($event)"
                              (blur)="onChangePatientType($event)"
                              fxLayout="row"
                            >
                              <mat-radio-button value="OP">OP</mat-radio-button>
                              <mat-radio-button value="IP">IP</mat-radio-button>
                              <mat-radio-button value="External">External</mat-radio-button>
                            </mat-radio-group>

                            <div fxFlex="30%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value != 'IP' && ItemSubform.get('PatientType').value != 'External'">
                              <airmid-autocomplete
                                label="OP-RegNo / First Name / Last Name / Mobile No"
                                [formGroup]="ItemSubform"
                                formControlName="RegID"
                                placeholderText="OP-RegNo / First Name / Last Name / Mobile No"
                                fxFlex
                                ApiUrl="OutPatient/auto-complete?Keyword="
                                (selectionChange)="getSelectedObjOP($event)"
                                TextField="formattedText"
                                ValueField="itemId"
                              ></airmid-autocomplete>
                            </div>

                            <div fxFlex="30%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value != 'OP' && ItemSubform.get('PatientType').value != 'External'">
                              <airmid-autocomplete
                                label="IP RegNo / First Name / Last Name / Mobile No"
                                [formGroup]="ItemSubform"
                                formControlName="RegID"
                                placeholderText="IP RegNo / First Name / Last Name / Mobile No"
                                fxFlex
                                ApiUrl="Admission/search-patient?Keyword="
                                (selectionChange)="getSelectedObjRegIP($event)"
                                TextField="formattedText"
                                ValueField="itemId"
                              ></airmid-autocomplete> 
                            </div>

                            <div fxFlex="100%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value == 'External'">
                              <airmid-textbox
                                label="MobileNo"
                                [(ngModel)]="MobileNo"
                                formControlName="MobileNo"
                                [formGroup]="ItemSubform"
                                [validations]="getValidationMessages().mobileNo"
                                [type]="'text'"
                                maxLength="10"
                              ></airmid-textbox>
                            </div>

                            <!-- Patient Name autocomplete pending -->
                            <div fxFlex="100%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value == 'External'">
                              <airmid-autocomplete
                                label="Patient Name"
                                [(ngModel)]="PatientName"
                                [formGroup]="ItemSubform"
                                formControlName="PatientName"
                                placeholderText="Patient Name"
                                fxFlex
                                ApiUrl="ItemMaster/GetItemListforSalesPage?StoreId=2&ItemName="
                                (selectionChange)="onPatientChange($event)"
                                TextField="formattedText"
                                ValueField="itemId"
                                (keydown)="onEnterpatientname($event)"
                              ></airmid-autocomplete>
                            </div>

                            <div fxFlex="100%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value == 'External'">
                              <airmid-autocomplete
                                label="DoctorName"
                                [formGroup]="ItemSubform"
                                [(ngModel)]="DoctorName"
                                formControlName="DoctorName"
                                placeholderText="DoctorName"
                                fxFlex
                                ApiUrl="ItemMaster/GetItemListforSalesPage?StoreId=2&ItemName="
                                (selectionChange)="onPatientChange($event)"
                                TextField="formattedText"
                                ValueField="itemId"
                              ></airmid-autocomplete>
                            </div>

                            <div fxFlex="100%" fxFlex.sm="100%" *ngIf="ItemSubform.get('PatientType').value == 'External'">
                              <airmid-textbox
                                label="Address"
                                [(ngModel)]="vextAddress"
                                formControlName="extAddress"
                                placeholder="extAddress"
                                [formGroup]="ItemSubform"
                                [validations]="getValidationMessages().mobileNo"
                                [type]="'text'"
                                (input)="onEnterAddress($event)"
                              ></airmid-textbox>
                            </div>
                          </div>
                        </div>
                        <div *ngIf="ItemSubform.get('PatientType').value != 'External' && RegId != ''">
                          <div class="content-card">
                            <div fxFlexFill fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="5px">
                              <div fxFlex.gt-sm="100%" fxFlex>
                                <div fxlayout="row" style="background-color: white">
                                  <!-- ================================ LABEL HEADER  -->
                                  <div class="patient-info-sales my-8">
                                    <!-- <fieldset class="fieldset-div" style="font-size: medium !important;"> -->
                                    <div class="sales-patient-info-title">
                                      <span style="font-weight: 700">Patient Information</span>
                                    </div>
                                    <div class="sales-patient-info" fxFlexFill fxLayout="row" fxLayoutAlign="space-between center" class="patient-info">
                                      <div class="patient-sub">
                                        <div class="patient-info-row patient-info-1-111 pt-8" fxLayout="row" fxLayoutAlign="space-between center">
                                          <div class="patient-col">
                                            <span class="patient-col-key">Patient Name</span>
                                            <span>:</span>
                                            <span class="patient-col-value">{{ RegNo }}-{{ PatientName }}</span>
                                          </div>
                                          <div class="patient-col" *ngIf="IPDNocheck">
                                            <span class="patient-col-key">IPDNo</span>
                                            <span>:</span>
                                            <span class="patient-col-value">{{ IPDNo }}</span>
                                          </div>
                                          <div class="patient-col" *ngIf="OPDNoCheck">
                                            <span class="patient-col-key">OPDNo</span>
                                            <span>:</span>
                                            <span class="patient-col-value">{{ OPDNo }}</span>
                                          </div>
                                          <div class="patient-col" *ngIf="DoctorNamecheck">
                                            <span class="patient-col-key">Doctor Name</span>
                                            <span>:</span>
                                            <span class="patient-col-value">Dr.{{ DoctorName }}</span>
                                          </div>

                                          <div class="patient-col">
                                            <span class="patient-col-key">Ward | Bed Name</span>
                                            <span>:</span>
                                            <span class="patient-col-value">{{ WardName }} | {{BedName}}</span>
                                          </div>

                                          <div class="patient-col">
                                            <span class="patient-col-key">Tariff Name</span>
                                            <span>:</span>
                                            <span class="patient-col-value">{{ TariffName }}</span>
                                          </div>
                                          <!-- <div class="patient-col">
                                            <span class="patient-col-key">Company Name</span>
                                            <span>:</span>
                                            <span class="patient-col-value" style="color: #e26d14">{{ CompanyName }}</span>
                                          </div> -->
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </form>
                    </mat-card-content>
                  </mat-card>
                </div>
              </div>
              <div class="modal-card-container input-error-hidden">
                <mat-card>
                  <mat-card-content>
                    <form [formGroup]="_salesService.ItemSearchGroup">
                      <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" fusePerfectScrollbar>
                    
                        <div fxFlex="100%" fxFlex.gt-sm="8%">
                          <airmid-textbox label="Barcode No" formControlName="Barcode" [(ngModel)]="vBarcode"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>
                    
                        <div fxFlex="100%">
                          <airmid-autocomplete label="Item Name (enter 2 char)" [formGroup]="_salesService.ItemSearchGroup"
                            formControlName="ItemId" placeholderText="Item Name (enter 2 char)" fxFlex
                            ApiUrl="ItemMaster/GetItemListforSalesPage?StoreId=2&ItemName=" TextField="itemName" ValueField="itemId"
                            (selectionChange)="onItemChange($event)" #itemid></airmid-autocomplete>
                          <!-- (selectionChange)="getSelectedObj($event)" -->
                        </div>
                    
                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Batch No" [(ngModel)]="BatchNo" formControlName="BatchNo" [readonly]="true"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>

                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Qty" [(ngModel)]="Qty" formControlName="Qty" #qtyInputRef type="number" min="0"
                            (valueChange)="calculateTotalAmt()" [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div> 

                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="MRP" [(ngModel)]="MRP" formControlName="MRP" type="number" [readonly]="true"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>

                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Total MRP" [(ngModel)]="TotalMRP" formControlName="TotalMrp" [readonly]="true"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>
                    
                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Disc %" [(ngModel)]="DiscPer" formControlName="DiscPer" type="number"
                            (valueChange)="discperCal()" [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>
                    
                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Disc Amt" [(ngModel)]="DiscAmt" formControlName="DiscAmt" type="number"
                            [disabled]="chkdiscper" (valueChange)="CaldiscAmount()"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>
                    
                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Net Amount" [(ngModel)]="NetAmt" formControlName="NetAmt" [readonly]="true"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>

                        <div fxFlex="100%" fxFlex.gt-sm="7%">
                          <airmid-textbox label="Margin Amount" [(ngModel)]="v_marginamt" formControlName="MarginAmt" [readonly]="true"
                            [formGroup]="_salesService.ItemSearchGroup"></airmid-textbox>
                        </div>
                    
                        <!-- [disabled]="!add" -->
                        <div matTooltip="Select  name to enable this button!!" [matTooltipDisabled]="!_salesService.ItemSearchGroup.invalid"
                          [matTooltipPosition]="'above'">
                          <button (click)="OnAddUpdate()" class="btn btn-primary btn-with-icon py-8"
                            [disabled]="!this._salesService.ItemSearchGroup.valid" #addbutton> <!-- [disabled]="!add" -->
                            <span class="btn-icon">
                              <mat-icon>add</mat-icon>
                            </span>
                          </button>
                          <!-- [disabled]="_salesService.ItemSearchGroup.invalid" -->
                        </div>
                      </div>
                    </form>
                  </mat-card-content>
                </mat-card>
              </div>
              <div class="modal-card-container dynamic-table-wrapper" fxFlex>
                <div class="airmid-table-container">
                  <mat-table class="airmid-table sales-table" #table matSort [dataSource]="saleSelectedDatasource" [@animateStagger]="{ value: '50' }" style="overflow: auto">
                    <ng-container matColumnDef="ItemName">
                      <mat-header-cell *matHeaderCellDef class="w-180" mat-sort-header>ItemName</mat-header-cell>
                      <mat-cell *matCellDef="let contact" class="w-180">
                        <span>{{ contact.ItemName }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="BatchNo">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Batch No</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.BatchNo }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="BatchExpDate">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Exp.Date</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.BatchExpDate }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="Qty">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm class="w-100">Qty</mat-header-cell>
                      <mat-cell class="w-100" *matCellDef="let contact" fxShow.gt-sm>
                        <mat-form-field appearance="fill">
                          <input matInput [(ngModel)]="contact.Qty" type="number" (keyup)="getCellCalculation(contact)" min="0"/>
                        </mat-form-field>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="UnitMRP">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Unit MRP</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.UnitMRP }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="TotalMRP">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Total MRP</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.TotalMRP | currency : 'INR' }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="GSTPer">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm class="w-90">GST %</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-90">
                      <span>  {{ contact.GSTPer }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="GSTAmount">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>GST Amt</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.GSTAmount | currency : 'INR' }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="DiscPer">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc %</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                        <mat-form-field appearance="fill">
                          <input matInput [(ngModel)]="contact.DiscPer" type="number" (keyup)="updateCellDiscount(contact)"
                          min="0"/>
                        </mat-form-field>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="DiscAmt">
                      <mat-header-cell class="" *matHeaderCellDef mat-sort-header fxShow.gt-sm>Disc Amount</mat-header-cell>
                      <mat-cell class="" *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.DiscAmt | currency : 'INR' }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="NetAmt">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Net Amount</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.NetAmt | currency : 'INR' }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="MarginAmt">
                      <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>MarginAmt</mat-header-cell>
                      <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      <span>  {{ contact.MarginAmt | currency : 'INR' }}</span>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="buttons" stickyEnd>
                      <mat-header-cell *matHeaderCellDef class="table-actions">Action</mat-header-cell>
                      <mat-cell *matCellDef="let contact">
                        <ng-container class="actions">
                          <span class="material-icons" style="cursor: pointer; color: #5b5858" (click)="deleteTableRow($event, contact)">delete</span>
                        </ng-container>
                      </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="loading">
                      <mat-header-cell *matFooterCellDef colspan="6" style="display: none"></mat-header-cell>
                    </ng-container>

                    <ng-container matColumnDef="noData">
                      <mat-footer-cell *matFooterCellDef colspan="6">
                        <mat-spinner *ngIf="isLoadingStr == 'loading'" [diameter]="30"></mat-spinner>
                        <span *ngIf="isLoadingStr == 'no-data'">No data found...</span>
                      </mat-footer-cell>
                    </ng-container>

                    <mat-header-row class="accent min-width-1500" *matHeaderRowDef="selectedSaleDisplayedCol; sticky: true"></mat-header-row>
                    <mat-row *matRowDef="let contact; columns: selectedSaleDisplayedCol" class="min-width-1500" [ngClass]="{ 'row-yellow': QtyBalchk == 0 }" [@animate]="{ value: '*', params: { y: '100%' } }"></mat-row>
                    <!-- (click)="deleteTableRow($event,contact)"  -->
                    <!-- <button class="btn btn-default btn-primary" style="float:right;" (click)="deleteRow(pto)" 
                                                       (onDelete)="onDelete($event)"><i class="fa fa-trash" aria-hidden="true"></i></button> -->
                    <mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{ hide: saleSelectedDatasource != null }"></mat-footer-row>
                    <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(saleSelectedDatasource != null && saleSelectedDatasource.data.length == 0) }"></mat-footer-row>
                  </mat-table>
                </div>
              </div>
              <div class="modal-card-container">
                <mat-card fxFlex.gt-sm="100%" fxFlex>
                  <mat-card-content class="py-4">
                    <form class="example-form mt-12" [formGroup]="ItemSubform">
                      <div class="footer-container" fxLayout="column" fxLayoutAlign="start">
                        <div class="row row-container">
                          <div class="amount-section">
                            <div fxLayout="column" class="gap-16">
                              <div class="net-amt" fxLayout="row" fxLayoutAlign="space-between center">
                                <div class="net-amt-group no-of-items">
                                  <span class="net-amt-label fw-600">No of Items:</span>
                                  <span class="net-amt-value">
                                    {{ saleSelectedDatasource.data.length }}
                                  </span>
                                </div>
                                <div class="net-amt-group total-amt">
                                  <span class="net-amt-label fw-600">Total:</span>
                                  <span class="net-amt-value">
                                    {{ getMarginSum(saleSelectedDatasource.data) | currency : 'INR' }}
                                  </span>
                                </div>
                                <div class="net-amt-group total-gst">
                                  <span class="net-amt-label fw-600">Total GST:</span>
                                  <span class="net-amt-value">
                                    {{ getGSTAmtSum(saleSelectedDatasource.data) | currency : 'INR' }}
                                  </span>
                                </div>
                                <div class="net-amt-group net-amount">
                                  <span class="net-amt-label fw-600" style="background-color: aquamarine">Net Amount:</span>
                                  <span class="net-amt-value" style="background-color: aquamarine">
                                    {{ getNetAmtSum(saleSelectedDatasource.data) | currency : 'INR' }}
                                  </span>
                                </div>
                              </div>
                              <div fxLayout="row" fxLayoutAlign="start center" class="gap-8 input-error-hidden">
                                <div class="draft-btn">
                                  <button class="btn btn-primary" (click)="onSaveDraftBill()">DraftBill</button>
                                </div>
                                <airmid-textbox fxFlex="8%" label="Total Amount" [formGroup]="ItemSubform" formControlName="FinalTotalAmt" [(ngModel)]="FinalTotalAmt" [readonly]="true"></airmid-textbox>
  
                                <airmid-textbox
                                  fxFlex="7%"
                                  label="Discount %"
                                  [formGroup]="ItemSubform"
                                  formControlName="FinalDiscPer"
                                  [(ngModel)]="FinalDiscPer"
                                  (valueChange)="getFinalDiscperAmt()"
                                ></airmid-textbox>
  
                                <airmid-textbox
                                  fxFlex="8%"
                                  label="Discount Amount"
                                  [formGroup]="ItemSubform"
                                  formControlName="FinalDiscAmt"
                                  [(ngModel)]="FinalDiscAmt"
                                  (valueChange)="getFinalDiscAmount()"
                                  [readonly]="true"
                                  type="number"
                                ></airmid-textbox>
                                <!-- TODO: Pending -->
                                <mat-form-field appearance="outline" style="width: 200px" *ngIf="false">
                                  <mat-label>Concession Reason Type</mat-label>
                                  <mat-select formControlName="ConcessionId" #ConseId>
                                    <mat-option *ngFor="let Doc of ConcessionReasonList" [value]="Doc">
                                      {{ Doc.ConcessionReason }}
                                    </mat-option>
                                  </mat-select>
                                </mat-form-field>
  
                                <airmid-textbox
                                  fxFlex="8%"
                                  label="Net Amount"
                                  [formGroup]="ItemSubform"
                                  formControlName="FinalNetAmount"
                                  [(ngModel)]="FinalNetAmount"
                                  [readonly]="true"
                                  [required]="true"
                                ></airmid-textbox>
  
                                <airmid-textbox fxFlex="7%" label="Balance Amount" [formGroup]="ItemSubform" formControlName="BalanceAmt" [(ngModel)]="BalAmount"></airmid-textbox>
  
                                <airmid-textbox
                                  fxFlex="8%"
                                  label="Net Amount (Round off)"
                                  [formGroup]="ItemSubform"
                                  formControlName="roundoffAmt"
                                  [(ngModel)]="roundoffAmt"
                                  [readonly]="true"
                                ></airmid-textbox>
  
                                <airmid-textbox
                                  fxFlex
                                  label="Paid By Patient"
                                  [formGroup]="ItemSubform"
                                  formControlName="PaidbyPatient"
                                  [(ngModel)]="v_PaidbyPatient"
                                  (valueChange)="CalPaidbackAmt()"
                                ></airmid-textbox>
  
                                <airmid-textbox
                                  fxFlex
                                  label="Paid Back To Patient"
                                  [formGroup]="ItemSubform"
                                  formControlName="PaidbacktoPatient"
                                  [(ngModel)]="v_PaidbacktoPatient"
                                  [readonly]="true"
                                ></airmid-textbox>
                              </div>
                              <div class="sales-radio-buttons gap-8" fxLayout="row" fxLayoutAlign="space-between center">
                                <mat-radio-group aria-label="Select an option" formControlName="CashPay"  >
                                  <mat-radio-button value="Credit" *ngIf="paymethod">Credit</mat-radio-button>
                                  <mat-radio-button value="CashPay">Cash</mat-radio-button>
                                  <mat-radio-button value="Online">Online</mat-radio-button>
                                  <mat-radio-button value="PayOption">PayOption</mat-radio-button>
                                  <!-- <mat-radio-button value="Other">Multiple Pay</mat-radio-button> -->
                                </mat-radio-group>
  
                                <airmid-textbox
                                  fxFlex
                                  *ngIf="isPaymentSuccess"
                                  label="Referance no"
                                  [formGroup]="ItemSubform"
                                  formControlName="referanceNo"
                                  [(ngModel)]="v_PaidbacktoPatient"
                                  [readonly]="true"
                                ></airmid-textbox>
  
                                <div class="sales-footer-buttons gap-8" fxLayout="row">
                                  <button mat-raised-button (click)="getPRESCRIPTION()" class="btn btn-primary-outline">GET PRESCRIPTION</button>
  
                                  <button class="btn btn-primary" (click)="onSave($event)">Save(F9)</button>
                                  <button class="btn btn-primary-outline" *ngIf="IsOnlineRefNo" (click)="payOnline()">Online</button>
                                  <button class="btn btn-danger-outline" (click)="onClose()" (keydown.enter)="onF6Reset($event)">Reset</button>
                                </div>
                                <!-- [disabled]="ItemSubform.invalid || saleSelectedDatasource.data.length == 0" -->
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </form> 
                  </mat-card-content>
                </mat-card>
              </div>
            </div>
          </div>
        </div>
        <div fxFlex="20%" fxFlex.sm="30%" fxFlex.xs="100%" class="table-right">
          <mat-card fxFlexFill class="overflow-auto">
            <mat-card-content>
              <div class="sales-table-right-box" fxLayout="column" fxLayoutGap="6px">
                <mat-card>
                  <mat-card-content>
                    <div class="Sales-bill-summary px-12">
                      <div class="Sales-bill-summary-title pb-2 border-bottom">
                        <span class="h3 font-weight-600">Bill Summary</span>
                      </div>
                      <div class="bil-summary-list mt-8">
                        <ul class="gap-4 list-basic" fxLayout="column">
                          <li>
                            <div class="list-item">
                              <span class="list-item-key">Bill Amount :</span>
                              <span class="list-item-value">{{ roundoffAmt | currency : 'INR' }}</span>
                            </div>
                          </li>
                          <li>
                            <div class="list-item">
                              <span class="list-item-key">Credit Amount :</span>
                              <span class="list-item-value">{{ TotalCreditAmt | currency : 'INR' }}</span>
                            </div>
                          </li>
                          <li>
                            <div class="list-item">
                              <span class="list-item-key">Advance Amount :</span>
                              <span class="list-item-value">
                                {{ TotalAdvanceAmt | currency : 'INR' }}
                              </span>
                            </div>
                          </li>
                          <li>
                            <div class="list-item">
                              <span class="list-item-key">Adv.Balance Amount :</span>
                              <span class="list-item-value">{{ TotalBalanceAmt | currency : 'INR' }}</span>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </mat-card-content>
                </mat-card>
                <!-- Patient Table -->
                <mat-table class="airmid-table patient-table" matSort [dataSource]="dsPatientList" [@animateStagger]="{ value: '50' }">
                  <ng-container matColumnDef="UHID">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>UHID No</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{ row.UHID }}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="PatientName">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Patient Name</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{ row.PatientName }}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="NetAmt">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Net Amount</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{ row.NetAmt | currency : 'INR' }}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="MobileNo">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>Mobile No</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{ row.MobileNo }}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="UserName">
                    <mat-header-cell *matHeaderCellDef mat-sort-header>User Name</mat-header-cell>
                    <mat-cell *matCellDef="let row">{{ row.UserName }}</mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="noData">
                    <mat-footer-cell *matFooterCellDef colspan="6">
                      <span *ngIf="isLoadingStr == 'no-data'">No data found...</span>
                    </mat-footer-cell>
                  </ng-container>

                  <mat-header-row *matHeaderRowDef="patientDisplayedColumns" class="accent min-width-600"></mat-header-row>
                  <mat-row *matRowDef="let row; columns: patientDisplayedColumns" class="min-width-600"></mat-row>
                  <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(dsPatientList != null && dsPatientList.data.length == 0) }" class="min-width-600"></mat-footer-row>
                </mat-table>

                <!-- Draft Bill List -->
                <mat-table class="sales-table-right airmid-table" #table matSort [dataSource]="dsDraftList" [@animateStagger]="{ value: '50' }">
                  <ng-container matColumnDef="ExtMobileNo">
                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm>Mobile No</mat-header-cell>
                    <mat-cell *matCellDef="let contact" fxShow.gt-sm>
                      {{ contact.ExtMobileNo }}
                    </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="buttons" stickyEnd>
                    <mat-header-cell *matHeaderCellDef class="table-actions">Action</mat-header-cell>
                    <mat-cell *matCellDef="let contact">
                      <ng-container class="actions">
                        <span class="material-icons" (click)="onAddDraftList(contact)">
                          <mat-icon>add_shopping_cart</mat-icon>
                        </span>
                      </ng-container>
                    </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="loading">
                    <mat-header-cell *matFooterCellDef colspan="6" style="display: none"></mat-header-cell>
                  </ng-container>

                  <ng-container matColumnDef="noData">
                    <mat-footer-cell *matFooterCellDef colspan="6">
                      <mat-spinner *ngIf="isLoadingStr == 'loading'" [diameter]="30"></mat-spinner>
                      <span *ngIf="isLoadingStr == 'no-data'">No data found...</span>
                    </mat-footer-cell>
                  </ng-container>

                  <mat-header-row class="accent" *matHeaderRowDef="DraftSaleDisplayedCol; sticky: true"></mat-header-row>
                  <mat-row *matRowDef="let contact; columns: DraftSaleDisplayedCol" [ngClass]="{ 'row-yellow': QtyBalchk == 0 }" [@animate]="{ value: '*', params: { y: '100%' } }"></mat-row>
                  <mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{ hide: dsDraftList != null }"></mat-footer-row>
                  <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(dsDraftList != null && dsDraftList.data.length == 0) }"></mat-footer-row>
                </mat-table>

                <!-- Available Stock in Other Store -->
                <mat-table class="sales-table-right airmid-table" #table matSort [dataSource]="dsBalAvaListStore" [@animateStagger]="{ value: '50' }">
                  <ng-container matColumnDef="StoreName">
                    <mat-header-cell *matHeaderCellDef mat-sort-header fxShow.gt-sm class="w-190">Store Name</mat-header-cell>
                    <mat-cell *matCellDef="let contact" fxShow.gt-sm class="w-190">
                      {{ contact.StoreName }}
                    </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="BalQty" stickyEnd>
                    <mat-header-cell *matHeaderCellDef class="table-actions">Bal Qty</mat-header-cell>
                    <mat-cell *matCellDef="let contact">
                      {{ contact.BalQty }}
                    </mat-cell>
                  </ng-container>

                  <ng-container matColumnDef="loading">
                    <mat-header-cell *matFooterCellDef colspan="6" style="display: none"></mat-header-cell>
                  </ng-container>

                  <ng-container matColumnDef="noData">
                    <mat-footer-cell *matFooterCellDef colspan="6">
                      <mat-spinner *ngIf="isLoadingStr == 'loading'" [diameter]="30"></mat-spinner>
                      <span *ngIf="isLoadingStr == 'no-data'">No data found...</span>
                    </mat-footer-cell>
                  </ng-container>
                  <!-- (click)="show($event,contact)" -->
                  <mat-header-row class="accent" *matHeaderRowDef="DraftAvbStkListDisplayedCol; sticky: true"></mat-header-row>
                  <mat-row *matRowDef="let contact; columns: DraftAvbStkListDisplayedCol" [ngClass]="{ 'row-yellow': QtyBalchk == 0 }" [@animate]="{ value: '*', params: { y: '100%' } }"></mat-row>
                  <mat-footer-row *matFooterRowDef="['loading']" [ngClass]="{ hide: dsBalAvaListStore != null }"></mat-footer-row>
                  <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{ hide: !(dsBalAvaListStore != null && dsBalAvaListStore.data.length == 0) }"></mat-footer-row>
                </mat-table>
              </div>
              <div fxLayout="row" fxLayout.gt-xs="column" fxLayoutGap="8px" *ngIf="false">
                <div *ngFor="let item of salesIdWiseObj | keyvalue">
                  <div class="sale-detail-box">
                    <div class="sale-detail">
                      <div class="sale-no h5">
                        <span>Sales No:</span>
                        <span>{{ item.key }}</span>
                      </div>
                      <div class="sale-info" *ngFor="let ele of item.value">{{ ele.ItemShortName }} | {{ ele.Qty }} | {{ ele.UnitMRP }}</div>
                    </div>
                    <div class="repeat-button">
                      <button class="btn btn-primary btn-xs" (click)="Addrepeat(item)">repeat</button>
                    </div>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
    </div>

    <!-- Modal footer -->
    <!-- <div class="modal-footer">
            <div class="footer-navigation-container">
                <div class="modal-footer-buttons">
                    <button type="button" class="btn btn-danger-outline" [mat-dialog-close]="true"
                        aria-label="Close dialog" matTooltip="Close">Close</button>
                    <button type="button" class="btn btn-primary"
                        [disabled]="!totalChargeForm.valid || !chargeList.length || savebtn"
                        (click)="onsave()">Save</button>
                </div>
            </div>
        </div> -->
  </div>
</div>
